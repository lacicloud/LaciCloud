function FileTransferStats(e){this.completedBytes=-1,this.previousCompletedBytes=-1,this.totalBytes=e,this.previousSampleTime=-1,this._transferRateSamples=[]}function rot13(e){return e.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+13)?e:e-26)})}function basicURLValidate(e){var t=new RegExp("^\\s*https?://.+","i");return t.test(e)}function extractFileExtension(e){if("string"!=typeof e)return"";var t=e.split(".");return 1==t.length||2==t.length&&""==t[0]?"":t[t.length-1].toLowerCase()}function isEmpty(e){return null===e||"undefined"==typeof e||""===e}function ensureTrailingSlash(e){return"/"!=e.substr(e.length-1,1)?e+"/":e}function isSubPath(e,t){return!(t.length<e.length)&&(e=ensureTrailingSlash(e),t=ensureTrailingSlash(t),t.substr(0,e.length)==e)}function nameJoin(e){switch(e.length){case 0:return"";case 1:return e[0];default:for(var t="",n=0;n<e.length-1;++n)t+=e[n],n<e.length-2&&(t+=", ");return t+=" and "+e[e.length-1]}}function normalizeFileSize(e){if("number"!=typeof e)return"";for(var t="B",n=e,o=[[1099511627776,"TB"],[1073741824,"GB"],[1048576,"MB"],[1024,"KB"]],i=0;i<o.length;++i)if(e>=o[i][0]){n=e/o[i][0],n=n.toFixed(1),t=o[i][1];break}return"KB"==t&&(n=Math.round(n)),n+t}function parentPath(e){if(e.length<=1)return"/";for(var t="/"==e.substr(0,1);e.length&&"/"==e.substr(e.length-1,1);)e=e.substr(0,e.length-1);for(var n=[],o=e.split("/"),i=0;i<o.length-1;++i){var r=o[i];0!=r.length&&n.push(r)}return 0==n.length?"/":(t?"/":"")+n.join("/")}function parseErrorResponse(e,t){if(console.error(e),e.data&&e.data.errors)return e.data.errors.join(" ");var n=isEmpty(t)?"":" during "+t;return 408==e.status||e.status==-1?"OPERATION_TIMEOUT":"An unknown error occurred"+n+"."}function getLocalizedErrorFromResponse(e){return e.data&&e.data.localizedErrors&&0!=e.data.localizedErrors.length?e.data.localizedErrors[0]:null}function pathJoin(e,t){var n="/"==e.substr(e.length-1,1)?"":"/";return e+n+t}function responseIsUnsuccessful(e){return void 0==e.data||1!=e.data.success}function showResponseErrorWithTranslatedAction(e,t,n,o){function i(e){a.push(e),a.length==r&&n.$broadcast("modal-error:show",a.join(" "))}if(e.data&&e.data.localizedErrors)for(var r=e.data.localizedErrors.length,a=[],s=0;s<r;++s){var c=e.data.localizedErrors[s];"undefined"==typeof c.context||null==c.context,window.console&&window.console.error&&console.error(e.data),null==c.context&&(c.context={}),void 0==c.context.operation&&(c.context.operation=t),o(c.context.operation).then(function(e){c.context.operation=e,o(c.errorName,c.context).then(i,i)},function(){o(c.errorName,c.context).then(i,i)})}else n.$broadcast("modal-error:show",parseErrorResponse(e,t),null,{action:t})}function showResponseError(e,t,n,o){o(t).then(function(t){showResponseErrorWithTranslatedAction(e,t,n,o)},function(){showResponseErrorWithTranslatedAction(e,t,n,o)})}function splitFileExtension(e){var t=!1;"."==e.substr(0,1)&&(e=e.substr(1,e.length-1),t=!0);var n,o=e.split("."),i="";return o.length>1?(i="."+o[o.length-1],n=o.slice(0,o.length-1).join(".")):n=o[0],[(t?".":"")+n,i]}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt("0x"+t))}))}function b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function validateFileNameNonEmpty(e){return""!=e}function validateFileNameContainsNoSlash(e){return e.indexOf("/")==-1}function mapParseInt(e){return parseInt(e)}function simpleCompare(e,t){return e-t}function betaVersionComponentCompare(e,t){var n=e.indexOf("b")!=-1,o=t.indexOf("b")!=-1,i=e.split("b").map(mapParseInt),r=t.split("b").map(mapParseInt);if(n&&o){var a=simpleCompare(i[0],r[0]);return 0!=a?a:simpleCompare(i[1],r[1])}return n?i[0]>r[0]?1:-1:r[0]>i[0]?1:-1}function versionComponentCompare(e,t){return e.indexOf("b")!=-1||t.indexOf("b")!=-1?betaVersionComponentCompare(e,t):simpleCompare(parseInt(e),parseInt(t))}function versionIsLessThan(e,t){var n=e.split(".");2==n.length&&n.push("0");var o=t.split(".");2==o.length&&o.push("0");for(var i=0;i<3;++i){var r=versionComponentCompare(n[i],o[i]);if(0!=r)return r<0}return!1}var TRANSFER_RATE_UPDATE_INTERVAL=200,TRANSFER_BYTES_MIN_UPDATE=8192,TRANSFER_RATE_SAMPLES_MAX=10,AUTOSAVE_DELAY_MS=3e3,MAX_CONCURRENT_UPLOADS=1,MAX_UPLOAD_BYTES=-1,UPLOAD_ACTION="uploadFileToNewDirectory",UPLOAD_ARCHIVE_ACTION="uploadArchive",API_PATH="application/api/api.php",DOWNLOAD_PATH="application/api/download.php",UPLOAD_PATH="application/api/upload.php",MULTI_STAGE_UPLOAD_PATH="application/api/upload-multistage.php",CM_MODE_BASE="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/",EXTRACT_UPLOAD=!1,DEBUG=!1,FEATURE_ENABLE_MULTI_STAGE_UPLOAD=!1,g_ConnectionDefaults={ftp:{port:21},sftp:{port:22}};angular.module("MonstaFTP",["pascalprecht.translate"]),angular.module("MonstaFTP").config(["$httpProvider",function(e){"use strict";var t=0;e.interceptors.push(["$rootScope","$q",function(e,n){var o=function(n){t+=n,e.$broadcast("request-count-change",t)};return{request:function(e){return e.__ignoreStatusIndicator||o(1),e},responseError:function(e){return console.error(e),e.config.__ignoreStatusIndicator||o(-1),n.reject(e)},response:function(e){return e.config.__ignoreStatusIndicator||o(-1),e}}}])}]),angular.module("MonstaFTP").config(["$translateProvider",function(e){"use strict";if(e.useSanitizeValueStrategy("escape"),window.underTest||e.useStaticFilesLoader({prefix:"application/languages/",suffix:".json"}),e.useMessageFormatInterpolation(),e.fallbackLanguage("en_us"),window.localStorage)try{var t=localStorage.getItem("monsta-setting-language");t&&(g_defaultLanguage=JSON.parse(t))}catch(e){}e.preferredLanguage(g_defaultLanguage)}]),function(){function e(){var e="monsta-configuration",t="monsta-connectionType",n="monsta-initialDirectory",o="monsta-rememberLogin",i="monsta-isAuthenticated",r="monsta-hasServerSavedAuthentication";return{isAuthenticated:!1,rememberLogin:!1,configuration:null,connectionType:null,initialDirectory:null,hasServerSavedAuthentication:!1,_localStorageSupported:null,getConfigurationAsJSON:function(){return JSON.stringify(this.configuration)},setConfigurationFromJSON:function(e){this.configuration=null==e?null:JSON.parse(e)},localStorageSupported:function(){if(null==this._localStorageSupported){var e="test",t=window.localStorage;try{t.setItem(e,"1"),t.removeItem(e),this._localStorageSupported=!0}catch(e){this._localStorageSupported=!1}}return this._localStorageSupported},postLogin:function(){this.isAuthenticated=!0,this.saveSettings()},loadSettings:function(){this.localStorageSupported()&&(this.loadMetaConfiguration(),this.rememberLogin&&this.loadConfiguration())},saveSettings:function(){this.localStorageSupported()&&(this.saveMetaConfiguration(),this.rememberLogin?this.saveConfiguration():this.clearConfiguration())},clearSettings:function(){this.localStorageSupported()&&(this.rememberLogin||this.clearConfiguration())},logout:function(){this.isAuthenticated=!1,this.initialDirectory=null,this.saveSettings(),this.clearSettings(),this.configuration=null},loadConfiguration:function(){this.localStorageSupported()&&(this.setConfigurationFromJSON(localStorage.getItem(e)),this.connectionType=localStorage.getItem(t),this.initialDirectory=localStorage.getItem(n))},saveConfiguration:function(){this.localStorageSupported()&&(localStorage.setItem(e,this.getConfigurationAsJSON()),localStorage.setItem(t,this.connectionType),localStorage.setItem(n,this.initialDirectory))},clearConfiguration:function(){localStorage.removeItem(e),localStorage.removeItem(t),localStorage.removeItem(n)},loadMetaConfiguration:function(){this.localStorageSupported()&&(this.rememberLogin="true"===localStorage.getItem(o),this.isAuthenticated="true"===localStorage.getItem(i),this.hasServerSavedAuthentication="true"===localStorage.getItem(r))},saveMetaConfiguration:function(){this.localStorageSupported()&&(localStorage.setItem(i,1==this.isAuthenticated?"true":"false"),localStorage.setItem(o,1==this.rememberLogin?"true":"false"),localStorage.setItem(r,1==this.hasServerSavedAuthentication?"true":"false"))},hasStoredAuthenticationDetails:function(){return!isEmpty(this.connectionType)&&!isEmpty(this.configuration)},getActiveConfiguration:function(){var e=this.configuration[this.connectionType];return"undefined"!=typeof e.port&&null!=e.port&&(e.port=parseInt(e.port)),e}}}angular.module("MonstaFTP").factory("authenticationFactory",e)}(),function(){function e(e,t,n){function o(e){return e.preventDefault(),u.changeDirectoryToItem(n(this).data("index")),!1}function i(e,t){var i=n('<li class="breadcrumb-display"></li>'),r=n('<a href="#" data-index="'+t+'"></a>').text(e+" ");return r.click(o),i.append(r),i}function r(){var e=15,t=120,o=n("#breadcrumb-ol"),r=n("#breadcrumb__home_link"),a=n("#history > button"),s=n(window).width(),c=s-a.width()-t,l=0;o.find(".breadcrumb-display").remove();for(var d=u.pathComponents.length-1,f=null,h=d;h>=0;--h){var p=u.pathComponents[h],m=i(p,h+1);if(null===f&&(f=m),r.after(m),l+=m.outerWidth(),l>c){if(h!=d&&m.remove(),0!=d){var g=i("…",h+1);r.after(g)}break}}if(l>c)for(var y=1;f.offset().left+f.outerWidth()+e>s;){++y;var v=u.pathComponents[d],S=v.length,C=v.substr(0,S-y);if(C+="…",f.text(C),S-y==1)break}}function a(e){return"string"!=typeof e||0==e.length?(u.pathComponents=[],void(u.hasLeadingSlash=!1)):(u.hasLeadingSlash="/"==e.substr(0,1),"/"==e?u.pathComponents=[]:(u.pathComponents=e.split("/"),""==u.pathComponents[0]&&u.pathComponents.splice(0,1),""==u.pathComponents[u.pathComponents.length-1]&&u.pathComponents.splice(u.pathComponents.length-1,1)),void u.renderBreadcrumbs())}function s(e){var n="";0!=e&&(n=u.pathComponents.slice(0,e).join("/"));var o=(u.hasLeadingSlash?"/":"")+n;t.$broadcast("change-directory",o)}function c(e,t){u.setPath(t)}var u=this;u.pathComponents=[],u.hasLeadingSlash=!1,u.renderBreadcrumbs=r,this.setPath=a,this.changeDirectoryToItem=s,e.$on("directory-changed",c),e.$on("logout",function(){u.setPath("/")}),n(window).resize(function(){u.renderBreadcrumbs()})}angular.module("MonstaFTP").controller("BreadcrumbController",e),e.$inject=["$scope","$rootScope","jQuery"]}(),function(){function e(e){var t=e.jQuery;return{jQuery:t,loadedModes:[],readOnly:!1,convertFilenameToMode:function(e){var t=extractFileExtension(e),n={htm:"htmlmixed",html:"htmlmixed",php:"php",asp:"htmlembedded",aspx:"htmlembedded",js:"javascript",css:"css",xhtml:"htmlmixed",cfm:"htmlembedded",pl:"perl",py:"python",c:"clike",cpp:"clike",rb:"ruby",java:"java",xml:"xml"};return n.hasOwnProperty(t)?n[t]:null},getModeDependencies:function(e){var t={htmlmixed:["xml","javascript","css"],php:["xml","javascript","css","htmlmixed","clike"]};return t.hasOwnProperty(e)?t[e]:null},generateModePath:function(e){return CM_MODE_BASE+e+"/"+e+".js"},setupCodeMirror:function(e,t,n){var o=CodeMirror.fromTextArea(t,{value:t.value,mode:e,lineNumbers:!0,lineWrapping:!0,readOnly:this.readOnly,autoRefresh:!0});n(o)},postScriptLoad:function(e,t,n){this.loadedModes.indexOf(e)==-1&&this.loadedModes.push(e),this.setupCodeMirror(e,t,n)},loadModeAfterDependencies:function(e,t,n){if(this.loadedModes.indexOf(e)!=-1)return void this.setupCodeMirror(e,t,n);var o=this;this.jQuery.getScript(this.generateModePath(e),function(){o.postScriptLoad.call(o,e,t,n)})},initiateCodeMirror:function(e,t,n){var o=this.getModeDependencies(e),i=[];if(null!=o)for(var r=0;r<o.length;++r)this.loadedModes.indexOf(o[r])==-1&&i.push(o[r]);if(0==i.length)this.loadModeAfterDependencies(e,t,n);else{var a=i[0],s=this;this.jQuery.getScript(this.generateModePath(a),function(){s.loadedModes.push(a),s.initiateCodeMirror.call(s,e,t,n)})}}}}angular.module("MonstaFTP").factory("codeMirrorFactory",e),e.$inject=["$window"]}(),function(){function e(e,t,n){function o(){return(null===l||d)&&(l=e.getSystemVars().then(i,r)),l}function i(e){return f=e.data.data}function r(e){return d=!0,t.reject(e)}function a(){return e.setApplicationSettings(f.applicationSettings)}function s(e,t){if(null!=f){void 0==f.applicationSettings&&(f.applicationSettings={});var o=f.applicationSettings[e]!=t;f.applicationSettings[e]=t,o&&n.$broadcast("configuration:key-changed",e,t)}}function c(e){return null==f?null:f.applicationSettings[e]}var u={getSystemConfiguration:o,saveApplicationSettings:a,setApplicationSetting:s,getApplicationSetting:c},l=null,d=!1,f=null;return u}angular.module("MonstaFTP").factory("configurationFactory",e),e.$inject=["connectionFactory","$q","$rootScope"]}(),function(){function e(e,t){function n(){if(null==f){var e="test",t=window.localStorage;try{t.setItem(e,"1"),t.removeItem(e),f=!0}catch(e){f=!1}}return f}function o(e){var t=localStorage.getItem(e);return"string"==typeof t?JSON.parse(t):t}function i(e,t){localStorage.setItem(e,JSON.stringify(t))}function r(e,t){e="monsta-setting-"+e,n()?i(e,t):h[e]=t}function a(e){return e="monsta-setting-"+e,n()?o(e):h[e]}function s(e){return void 0==a(e)?p[e]:a(e)}function c(){return e.getSystemConfiguration().then(function(e){p=e.applicationSettings},l)}function u(e,n){var o=a(e)!=n;r(e,n),o&&t.$broadcast("configuration:key-changed",e,n)}function l(e){return $q.reject(e)}var d={getApplicationSettings:c,getConfigurationItem:s,setConfigurationItem:u},f=null,h={},p={};return d}angular.module("MonstaFTP").factory("localConfigurationFactory",e),e.$inject=["configurationFactory","$rootScope"]}(),function(){function e(){var e=function(e,t){return e.isDirectory==t.isDirectory?0:e.isDirectory?-1:1},t=function(t,n){var o=e(t,n);return 0!=o?o:t.name.toLowerCase()==n.name.toLowerCase()?0:t.name.toLowerCase()>n.name.toLowerCase()?1:-1},n=function(n,o){var i=e(n,o);return 0!=i?i:n.modificationDate!=o.modificationDate?n.modificationDate-o.modificationDate:t(n,o)},o=function(n,o){var i=e(n,o);return 0!=i?i:n.size!=o.size?n.size-o.size:t(n,o)},i=function(n,o){var i=e(n,o);if(0!=i)return i;var r=extractFileExtension(n.name),a=extractFileExtension(o.name);return r!=a?r>a?1:-1:t(n,o)};return{_handleReverse:function(e,t){return t&&e.reverse(),e},sortByName:function(e,n){return this._handleReverse(e.sort(t),n)},sortByModificationDate:function(e,t){return this._handleReverse(e.sort(n),t)},sortBySize:function(e,t){return this._handleReverse(e.sort(o),t)},sortByType:function(e,t){return this._handleReverse(e.sort(i),t)}}}angular.module("MonstaFTP").factory("directorySortingFactory",e)}(),function(){function e(e,t){"use strict";function n(e){if(e.dataTransfer.types){for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1}}function o(t){t.preventDefault();var n=t.dataTransfer.items;if(void 0!=n)e.handleItemsBasedUpload(n,null);else{var o=t.dataTransfer.files;e.handleFilesBasedUpload(o,null)}}var i=!1,r=this,a=t("html");r.handleDropEvent=o,a.ready(function(){var e=t("#file-xfer-drop");a.on("dragenter",function(){var n=t("#files");e.css({top:n.position().top,height:n.height(),display:"table"}),e.show()}),a.on("dragend",function(){i||e.hide()}),e.ready(function(){e.on({dragenter:function(e){i=!0,e.stopPropagation(),e.preventDefault()},dragleave:function(n){t.contains(e,t(n.target))||(i=!1),n.stopPropagation(),n.preventDefault(),e.hide()},dragover:function(e){e.stopPropagation(),e.preventDefault()},drop:function(t){i=!1,t.stopPropagation(),t.preventDefault();var o=t.originalEvent;return!(!o.dataTransfer||!o.dataTransfer.files)&&(!!n(o)&&(r.handleDropEvent(o),void e.hide()))},dragend:function(t){t.stopPropagation(),t.preventDefault(),e.hide()}})})})}angular.module("MonstaFTP").controller("DragDropController",e),e.$inject=["uploadUIFactory","jQuery"]}(),function(){function e(e,t,n,o,i,r,a,s,c,u,l,d,f,h,p,m){"use strict";function g(){null!=Ee.systemVars&&1==Re&&Ee.changeDirectory(r.initialDirectory,!0)}function y(e){return{position:"fixed",left:e.clientX+Te+"px",top:e.clientY+Ae+"px","margin-left":0,"margin-top":0}}function v(e,t){C(e.clientX+Te,t)&&t.css("margin-left",-(t.width()+Fe)),E(e.clientY+Ae,t)&&t.css("margin-top",-(t.height()+Fe))}function S(){s(".context-catcher-tr").contextmenu(function(e){var t=s(this),n=t.find(".dropdown-menu").first(),o=t.data("index");return _e=d.getSelectedItems().indexOf(o)!=-1,n.css(y(e)),s(this).find(".context-catcher-button").dropdown("toggle"),v(e,n),["DIV","TR","TD"].indexOf(e.target.tagName)==-1&&d.selectItem(o),!1});var e=s(".file-toolbar");e.on("shown.bs.dropdown",function(){var e=s(this).find(".dropdown-menu");Ie=e;var t=e.parent().removeClass("dropup");"fixed"!=e.css("position")&&e.offset().top+e.outerHeight()>s(window).height()-s("#footer").height()&&t.addClass("dropup")}),e.on("hidden.bs.dropdown",function(){var e=s(this).find(".dropdown-menu");e.attr("style",null),Ie=null})}function C(e,t){return e+t.width()>s(window).width()}function E(e,t){return e+t.height()>s(window).height()}function T(){e.directoryList=Ee.sortDirectoryList(e.directoryList,Ee.sortName,Ee.sortReversed)}function A(e){Ee.sortReversed=e==Ee.sortName&&!Ee.sortReversed,Ee.sortName=e,Ee.doReorder()}function F(e,t,n){var o=null;switch(t){case"name":o="sortByName";break;case"modified":o="sortByModificationDate";break;case"size":o="sortBySize";break;case"type":o="sortByType"}return null==o?e:u[o](e,n)}function R(n,i,s){e.directoryList=Ee.sortDirectoryList(i.data.data,Ee.sortName,Ee.sortReversed),o.currentDirectory=n,d.clearSelection(),s&&(e.isHistoryChangeDir||a.addEntry(o.currentDirectory),e.isHistoryChangeDir=!1,t.$broadcast("directory-changed",n),r.initialDirectory=n,r.saveSettings()),c(function(){Ee.setupContextMenuEvents()})}function b(e,i,r){h.getApplicationSettings().then(function(){var a;a=r?function(){}:function(e){i?Ee.changeDirectory("/"):showResponseError(e,"DIRECTORY_CHANGE_OPERATION",t,l)},n.listDirectory(e,h.getConfigurationItem("showDotFiles")).then(function(t){Ee.directoryListSuccess(e,t,e!=o.currentDirectory)},a)},function(e){showResponseError(e,"APPLICATION_SETTINGS_LOAD_OPERATION",t,l)})}function I(){Ee.changeDirectory(o.currentDirectory)}function _(e){if(responseIsUnsuccessful(e))return void showResponseError(e,"DOWNLOAD_OPERATION",t,l);var n=e.data.fileKey;i.location=DOWNLOAD_PATH+"?fileKey="+n}function w(e){showResponseError(e,"DOWNLOAD_OPERATION",t,l),t.$broadcast("modal-prompt:clear-busy")}function P(e){n.fetchFile(e).then(_,w)}function D(){var t=d.getSelectedItems(),i=[];t.map(function(t){i.push(e.directoryList[t].name)}),n.downloadMultipleFiles(o.currentDirectory,i).then(_,w)}function L(){var t=o.joinNameToCurrentDirectory(e.directoryList[d.getSelectedItems()[0]].name);Ee.downloadFileAtPath(t)}function x(){var t=d.getSelectedItems();t.length>1||e.directoryList[t[0]].isDirectory?Ee.downloadMultiple():Ee.downloadSingle()}function M(){var t=d.getSelectedItems().slice();return t.sort(function(e,t){return e-t}),t.map(function(t){return o.joinNameToCurrentDirectory(e.directoryList[t].name)})}function O(e){0!=e.length&&o.setCopySource(e)}function $(e){0!=e.length&&o.setCutSource(e)}function N(){Ee.initiateCutOfPaths(Ee.getSelectedPaths())}function B(){Ee.initiateCopyOfPaths(Ee.getSelectedPaths())}function q(){l("EXISTING_FILE_SUFFIX").then(function(e){U(e)},function(){U("Copy")})}function U(e){if(null!=o.cutSource||null!=o.copySource){var i,r;null!=o.cutSource?(i=o.cutSource,r="rename"):(i=o.copySource,r="copy");for(var a=0;a<i.length;++a){var s=i[a];if(isSubPath(s,o.currentDirectory))return void t.$broadcast("modal-error:show","PASTE_TO_SUB_DIRECTORY_ERROR");var c=s.split("/"),u=Ce(c[c.length-1],e),d=o.joinNameToCurrentDirectory(u);n[r](s,d).then(function(){o.pasteComplete(),Ee.changeDirectory(o.currentDirectory),"rename"==r&&t.$broadcast("items-moved",[[s,d]])},function(e){showResponseError(e,"FILE_PASTE_OPERATION",t,l)})}}}function k(){var n=[].concat(e.directoriesToDelete||[],e.filesToDelete||[]);t.$broadcast("items-deleted",n),e.directoriesToDelete=null,e.filesToDelete=null,Ee.changeDirectory(o.currentDirectory)}function H(){var i=[];null!=e.filesToDelete&&e.filesToDelete.map(function(e){o.isCutOrCopySource(e)&&o.clearCutAndCopySource(),i.push([e,!1])}),null!=e.directoriesToDelete&&e.directoriesToDelete.map(function(e){o.isCutOrCopySource(e)&&o.clearCutAndCopySource(),i.push([e,!0])}),n.deleteMultiple(i).then(function(){Ee.deleteComplete()},function(e){showResponseError(e,"DELETE_ITEM_OPERATION",t,l),Ee.deleteComplete()})}function j(){e.filesToDelete=null,e.directoriesToDelete=null}function G(e){t.$broadcast("modal-confirm:show",e,Ee.confirmDelete,Ee.cancelDelete)}function V(e){l("DELETE_CONFIRM_MESSAGE",{item_count:e.length}).then(function(e){G(e)},function(e){G(e)})}function z(){var t=d.getSelectedItems();if(0!=t.length){var n=[];e.directoriesToDelete=[],e.filesToDelete=[];for(var i=0;i<t.length;++i){var r=t[i],a=e.directoryList[r];n.push(a.name);var s=o.joinNameToCurrentDirectory(a.name);a.isDirectory?e.directoriesToDelete.push(s):e.filesToDelete.push(s)}Ee.showDeleteConfirm(n)}}function Q(){Ee.newItemPath=null,e.makeItemType=null}function W(){return t.$broadcast("modal-prompt:hide"),Ee.refreshDirectoryList(),e.makeItemType==we?void Q():void h.getApplicationSettings().then(function(){var e=h.getConfigurationItem("editNewFilesImmediately");if(e&&Ee.itemIsEditable(!1,Ee.newItemPath)){var n=Ee.newItemPath.split("/");t.$broadcast("file-editor:edit",n[n.length-1],Ee.newItemPath)}Q()},function(e){Q(),showResponseError(e,"RENAME_OPERATION",t,l)})}function K(e,n){t.$broadcast("modal-prompt:clear-busy"),l(["NEW_ITEM_FAILURE_PRECEDING_MESSAGE",e],n).then(function(t){ne(t.NEW_ITEM_FAILURE_PRECEDING_MESSAGE+" "+t[e])})}function X(e){return validateFileNameNonEmpty(e)?validateFileNameContainsNoSlash(e)?null:"FILE_NAME_CONTAINS_SLASH_MESSAGE":"FILE_NAME_EMPTY_MESSAGE"}function Y(e,t){l(e,t).then(ne,ne)}function J(i){t.$broadcast("modal-prompt:clear-error");var r=X(i);if(null!=r)return void l(e.makeItemType).then(function(e){Y(r,{item_type:e.toLowerCase()})},function(){Y(r,{item_type:e.makeItemType.toLowerCase()})});Ee.newItemPath=o.joinNameToCurrentDirectory(i),t.$broadcast("modal-prompt:set-busy","CREATING_ACTIVITY_STATUS");var a;e.makeItemType==we?a=n.makeDirectory(Ee.newItemPath):e.makeItemType==Pe&&(a=n.putFileContents(Ee.newItemPath,"")),a.then(function(){Ee.makeItemSuccessCallback()},function(t){var n=e.makeItemType.toUpperCase()+"_MAKE_OPERATION",o=function(n){Ee.makeItemFailureCallback(parseErrorResponse(t,n),{item_type:e.makeItemType,action:n})};l(n).then(function(e){o(e)},function(){o(n)})})}function Z(e){l(["NEW_ITEM_PROMPT_TITLE","NEW_ITEM_NAME_PLACEHOLDER"],{item_type:e}).then(function(e){t.$broadcast("modal-prompt:show",e.NEW_ITEM_PROMPT_TITLE,"",e.NEW_ITEM_NAME_PLACEHOLDER,Ee.makeItemOKCallback)})}function ee(t){e.makeItemType=t,l(t).then(function(e){Z(e)},function(){var t=e.makeItemType.toLowerCase().capitalizeFirstLetter();Z(t)})}function te(){if(0!=e.selectedItems.length){var n=[],i=-1;e.selectedItems.map(function(t){var r=e.directoryList[t];n.push(o.joinNameToCurrentDirectory(r.name)),i==-1?i=r.numericPermissions:r.numericPermissions!=i&&(i=0)}),t.$broadcast("modal-permissions:show",n,i)}}function ne(e){t.$broadcast("modal-prompt:set-error",e)}function oe(e,i){if(t.$broadcast("modal-prompt:clear-error"),i!=e){var r=X(e);if(null!=r)return void Y(r,{item_type:"item"});t.$broadcast("modal-prompt:set-busy","RENAMING_ACTIVITY_STATUS");var a=o.joinNameToCurrentDirectory(i),s=o.joinNameToCurrentDirectory(e);n.rename(a,s).then(function(e){return t.$broadcast("modal-prompt:clear-busy"),responseIsUnsuccessful(e)?void showResponseError(e,"RENAME_OPERATION",t,l):(Ee.refreshDirectoryList(),t.$broadcast("items-moved",[[a,s]]),void t.$broadcast("modal-prompt:hide"))},function(e){t.$broadcast("modal-prompt:clear-busy"),showResponseError(e,"RENAME_OPERATION",t,l)}),Ee.renameSource=null}}function ie(e){t.$broadcast("modal-prompt:show",e.RENAME_FILE_PROMPT_TITLE,Ee.renameSource,e.RENAME_FILE_NAME_PLACEHOLDER,Ee.fileRenameCallback)}function re(){l(["RENAME_FILE_PROMPT_TITLE","RENAME_FILE_NAME_PLACEHOLDER"]).then(ie,ie)}function ae(e,t){e!=o.currentDirectory&&("undefined"!=typeof e&&null!=e||(e=o.currentDirectory),Ee.changeDirectory(e,!1,t))}function se(){o.currentDirectory=null,r.initialDirectory=null,e.directoryList=[],a.clearHistory()}function ce(e){Ee.systemVars=e,Ee.setEditableExtensions(f.getApplicationSetting("editableFileExtensions")),m.isLicensed()&&(Ee.enableChmod=!f.getApplicationSetting("disableChmod"),Ee.enableFileView=!f.getApplicationSetting("disableFileView"),Ee.enableFileEdit=Ee.enableFileView&&!f.getApplicationSetting("disableFileEdit")),g()}function ue(e){showResponseError(e,"SYSTEM_VAR_LOAD_OPERATION",t,l)}function le(e){var t=e.split(",");be=[];for(var n=0;n<t.length;++n){var o=t[n].trim().toLowerCase();""!=o&&be.push(o)}}function de(e,t){if(e)return!1;var n=t.split("/"),o=n[n.length-1],i=extractFileExtension(o);return""==i||be.indexOf(i)!=-1}function fe(){Ee.changeDirectory(parentPath(o.currentDirectory),!1)}function he(e){t.$broadcast("modal-properties:show",e)}function pe(t){if(3==t.which&&"files"==t.target.id){e.hasPasteSource=null!=o.cutSource||null!=o.copySource,Ie&&Ie.dropdown("toggle");var n=s("#extras-dropdown-button");n.dropdown("toggle");var i=s("#extras-dropdown");return i.css(y(t)),v(t,i),!1}}function me(e){p.mouseDown(e)}function ge(e,t){p.mouseMove(e,t)}function ye(e){p.mouseUp(e,_e),_e=!1}function ve(e){p.mouseLeave(e)}function Se(t){for(var n=0;n<e.directoryList.length;++n)if(e.directoryList[n].name==t)return!0;return!1}function Ce(e,t){var n=e;if(!Se(n))return n;var o=splitFileExtension(n);if(n=o[0]+" - "+t+o[1],!Se(n))return n;for(var i=2;;++i){var r=o[0]+" - "+t+" "+i+o[1];if(!Se(r))return r}}var Ee=this,Te=7,Ae=14,Fe=20,Re=!1,be=[],Ie=null,_e=!1,we="FOLDER",Pe="FILE";e.directoryList=[],e.selectedItems=d.getSelectedItems(),e.directoriesToDelete=null,e.filesToDelete=null,e.isHistoryChangeDir=!1,Ee.sortName="name",Ee.sortReversed=!1,Ee.renameSource=null,Ee.rowDragStartIndex=null,Ee.isMetaDrag=!1,Ee.previousDragOverIndex=null,Ee.uiOperationFactory=o,Ee.systemVars=null,Ee.enableChmod=!0,Ee.enableFileView=!0,Ee.enableFileEdit=!0,Ee.didLogout=se,Ee.doReorder=T,Ee.cancelDelete=j,Ee.performPaste=q,Ee.confirmDelete=H,Ee.deleteComplete=k,Ee.downloadSingle=L,Ee.initiateRename=re,Ee.changeDirectory=b,Ee.downloadMultiple=D,Ee.getSelectedPaths=M,Ee.initiateMakeItem=ee,Ee.showDeleteConfirm=V,Ee.sortDirectoryList=F,Ee.downloadFileAtPath=P,Ee.fileRenameCallback=oe,Ee.initiateCutOfPaths=$,Ee.makeItemOKCallback=J,Ee.handleReorderChange=A,Ee.initiateCopyOfPaths=O,Ee.directoryListSuccess=R,Ee.refreshDirectoryList=I,Ee.downloadSelectedFiles=x,Ee.handleChangeDirectory=ae,Ee.makeItemSuccessCallback=W,Ee.makeItemFailureCallback=K,Ee.setupContextMenuEvents=S,Ee.initiateCutOfSelectedPaths=N,Ee.initiateCopyOfSelectedPaths=B,Ee.initiateChmodOfSelectedItems=te,Ee.initiateDeleteOfSelectedPaths=z,Ee.rowMouseDown=me,Ee.rowMouseMove=ge,Ee.rowMouseUp=ye,Ee.rowMouseLeave=ve,Ee.setEditableExtensions=le,Ee.itemIsEditable=de,Ee.navigateUpOneLevel=fe,Ee.showProperties=he,Ee.handleBodyClick=pe,Ee.getPasteName=Ce,e.editItem=function(e){var n=o.joinNameToCurrentDirectory(e.name);t.$broadcast("file-editor:edit",e.name,n)},e.initiateRenameOfItem=function(e){Ee.renameSource=e.name,Ee.initiateRename()},e.$on("change-directory:on-history",function(t,n){e.isHistoryChangeDir=!0,Ee.handleChangeDirectory(n)}),e.$on("change-directory",function(t,n){e.isHistoryChangeDir=!1,Ee.handleChangeDirectory(n)}),e.$on("change-directory:on-upload",function(){Ee.handleChangeDirectory(null,!0)}),e.handleClick=function(e,t){if(!(e.ctrlKey||e.metaKey||e.shiftKey)){e.stopPropagation();var n=this.item;if(n.isDirectory){var i=o.joinNameToCurrentDirectory(n.name);Ee.changeDirectory(i)}else s(e.target.parentNode.parentNode).find(".context-catcher-button").dropdown("toggle"),d.selectItem(t)}},e.$on("footer-button-click",function(e,t){switch(t){case"download":Ee.downloadSelectedFiles();break;case"cut":Ee.initiateCutOfSelectedPaths();break;case"copy":Ee.initiateCopyOfSelectedPaths();break;case"paste":Ee.performPaste();break;case"delete":Ee.initiateDeleteOfSelectedPaths();break;case"new-folder":Ee.initiateMakeItem("FOLDER");break;case"new-file":Ee.initiateMakeItem("FILE");break;case"chmod":Ee.initiateChmodOfSelectedItems()}}),e.$on("license-loaded",function(){f.getSystemConfiguration().then(ce,ue)}),e.$on("login",function(){Re=!0,g()}),e.$on("selected-items-changed",function(){e.selectedItems=d.getSelectedItems()}),e.$on("logout",function(){Ee.didLogout()}),e.$on("configuration:key-changed",function(e,t,n){"editableFileExtensions"==t&&Ee.setEditableExtensions(n)})}angular.module("MonstaFTP").controller("FileBrowserController",e),e.$inject=["$scope","$rootScope","connectionFactory","uiOperationFactory","$window","authenticationFactory","historyFactory","jQuery","$timeout","directorySortingFactory","$translate","selectedItemsFactory","configurationFactory","localConfigurationFactory","rowMouseTrackerFactory","licenseFactory"]}(),function(){function e(){return{replace:!0,scope:{sortIdentifier:"&",sortName:"&",vm:"="},template:'<span ng-click="vm.handleReorderChange(sortIdentifier)" data-sort-dir="">{{ sortName|translate }}<i ng-show="vm.sortName == sortIdentifier" class="fa" ng-class="{\'fa-caret-up\': !vm.sortReversed, \'fa-caret-down\': vm.sortReversed}" aria-hidden="true"></i></span>',restrict:"E",link:function(e,t,n){e.sortName=n.sortName,e.sortIdentifier=n.sortIdentifier}}}angular.module("MonstaFTP").directive("monstaReorder",e)}(),function(){function e(){return{replace:!0,scope:{sortIdentifier:"&",sortName:"&",vm:"="},template:'<li><a href="#" ng-click="vm.handleReorderChange(sortIdentifier)" data-sort-dir="" translate>{{ sortName }}</a></li>',restrict:"E",link:function(e,t,n){e.sortName=n.sortName,e.sortIdentifier=n.sortIdentifier}}}angular.module("MonstaFTP").directive("monstaReorderMobile",e)}(),function(){function e(e){function t(e){l=!0,c=e,d=!1}function n(e,t){!l||d||t||u.mouseClick(c,e),l=!1,h=null}function o(e,t){if(l){if(d=!0,h==t)return;null==h?u.startDrag(e,t):u.mouseDrag(t),h=t}}function i(e){return f.indexOf(e.target.tagName)!=-1||void(h=null)}function r(t){p?e.metaDraggedToIndex(t):e.draggedToIndex(t)}function a(t,n){return f.indexOf(t.target.tagName)==-1||(t.preventDefault(),void(t.ctrlKey||t.metaKey?e.metaClickAtIndex(n):t.shiftKey?e.shiftClickAtIndex(n):"SPAN"!=t.target.tagName&&e.standardClickAtIndex(n)))}function s(t,n){t.metaKey||t.ctrlKey?(p=!0,e.startMetaDraggingAtIndex(n)):(p=!1,e.startDraggingAtIndex(n))}var c,u={},l=!1,d=!1,f=["DIV","TR","TD","SPAN"],h=null,p=!1;return u.mouseDown=t,u.mouseUp=n,u.mouseMove=o,u.mouseLeave=i,u.mouseClick=a,u.mouseDrag=r,u.startDrag=s,u}angular.module("MonstaFTP").factory("rowMouseTrackerFactory",e),e.$inject=["selectedItemsFactory"]}(),function(){function e(e){function t(e,t){if(e==t)return[e];var n=1;e>t&&(n=-1);var o=[e];do e+=n,o.push(e);while(e!=t);return o}function n(){return p}function o(e){return 1==p.length&&p[0]==e?(p=[],void f()):void((p.indexOf(e)==-1||p.length>1)&&(p=[e],m=e,f()))}function i(e){1==p.length&&p.indexOf(e)!=-1||(p=t(m,e),f())}function r(e){var t=p.indexOf(e);t==-1?p.push(e):p.splice(t,1),f()}function a(){p=[],f()}function s(e){a(),g=e,p=[e],f()}function c(e){p=t(g,e),f()}function u(e){y=e,h=angular.copy(p)}function l(e){for(var t=angular.copy(h),n=Math.min(e,y),o=Math.max(e,y);n<=o;++n){var i=h.indexOf(n);i==-1?t.push(n):t.splice(t.indexOf(n),1)}p=t,f()}function d(e){p=[e],f()}function f(){e.$broadcast("selected-items-changed")}var h,p=[],m=0,g=0,y=0,v={getSelectedItems:n,standardClickAtIndex:o,shiftClickAtIndex:i,metaClickAtIndex:r,clearSelection:a,startDraggingAtIndex:s,draggedToIndex:c,startMetaDraggingAtIndex:u,metaDraggedToIndex:l,selectItem:d};return v}angular.module("MonstaFTP").factory("selectedItemsFactory",e),e.$inject=["$rootScope"]}(),function(){function e(e,t){var n=window.g_xhrTimeoutSeconds||30,o=["downloadMultipleFiles","fetchRemoteFile","copy","extractArchive","deleteMultiple","transferUploadToRemote"],i=function(e,t,n){
e.actionName=t,e.context={remotePath:n}},r=function(e,t,n,o){e.actionName=t,e.context={source:n,destination:o}};return{_sendRequest:function(t,i){var r=o.indexOf(t.actionName)==-1?1e3*n:null,a={method:"POST",url:API_PATH,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(e[n])));return t.join("&")},timeout:r,data:{request:t},__ignoreStatusIndicator:!!i};return DEBUG&&console.log(a),e(a)},getRequestBody:function(){var e=angular.copy(t.getActiveConfiguration()),n=g_ConnectionDefaults[t.connectionType];if(n)for(var o in n)n.hasOwnProperty(o)&&(null!=e[o]&&void 0!=e[o]&&""!=e[o]||(e[o]=n[o]));return{connectionType:t.connectionType,configuration:e}},getEmptyRequestBody:function(){return{connectionType:null,configuration:null}},getListDirectoryRequest:function(e,t,n){e.actionName="listDirectory",e.context={path:t,showHidden:n}},getFetchFileRequest:function(e,t){i(e,"fetchFile",t)},getMakeDirectoryRequest:function(e,t){i(e,"makeDirectory",t)},getDeleteDirectoryRequest:function(e,t){i(e,"deleteDirectory",t)},getDeleteFileRequest:function(e,t){i(e,"deleteFile",t)},getCopyRequest:function(e,t,n){r(e,"copy",t,n)},getRenameRequest:function(e,t,n){r(e,"rename",t,n)},getChangePermissionsRequest:function(e,t,n){i(e,"changePermissions",t),e.context.mode=n},getPutFileContentsRequest:function(e,t,n,o){e.actionName="putFileContents",e.context={remotePath:t,fileContents:n},o&&(e.context.encoding="rot13")},getGetFileContentsRequest:function(e,t){e.actionName="getFileContents",e.context={remotePath:t}},getTestConnectAndAuthenticateRequest:function(e){e.actionName="testConnectAndAuthenticate",e.context={}},getCheckSavedAuthExistsRequest:function(e){e.actionName="checkSavedAuthExists",e.context={}},getWriteSavedAuthRequest:function(e,t,n){e.actionName="writeSavedAuth",e.context={password:t,authData:n}},getReadSavedAuthRequest:function(e,t){e.actionName="readSavedAuth",e.context={password:t}},getReadLicenseRequest:function(e){e.actionName="readLicense",e.context={}},getGetSystemVarsRequest:function(e){e.actionName="getSystemVars",e.context={}},getFetchRemoteFileRequest:function(e,t,n){r(e,"fetchRemoteFile",t,n)},getDownloadMultipleFilesRequest:function(e,t,n){e.actionName="downloadMultipleFiles",e.context={baseDirectory:t,items:n}},getSetApplicationSettingsRequest:function(e,t){e.actionName="setApplicationSettings",e.context={applicationSettings:t}},getDeleteMultipleRequest:function(e,t){e.actionName="deleteMultiple",e.context={pathsAndTypes:t}},getExtractArchiveRequest:function(e,t,n,o){e.actionName="extractArchive",e.context={fileKey:t,fileIndexOffset:n,extractCount:o}},getUpdateLicenseRequest:function(e,t){e.actionName="updateLicense",e.context={license:t}},getReserveUploadContextRequest:function(e,t,n){e.actionName="reserveUploadContext",e.context={actionName:t,remotePath:n}},getTransferUploadToRemoteRequest:function(e,t){e.actionName="transferUploadToRemote",e.context={sessionKey:t}},getGetRemoteFileSizeRequest:function(e,t){e.actionName="getRemoteFileSize",e.context={remotePath:t}},listDirectory:function(e,t){return this.requestBody=this.getRequestBody(),this.getListDirectoryRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},fetchFile:function(e){return this.requestBody=this.getRequestBody(),this.getFetchFileRequest(this.requestBody,e,!0),this._sendRequest(this.requestBody)},rename:function(e,t){return this.requestBody=this.getRequestBody(),this.getRenameRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},changePermissions:function(e,t){return this.requestBody=this.getRequestBody(),this.getChangePermissionsRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},copy:function(e,t){return this.requestBody=this.getRequestBody(),this.getCopyRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},deleteFile:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteFileRequest(this.requestBody,e),this._sendRequest(this.requestBody)},deleteDirectory:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteDirectoryRequest(this.requestBody,e),this._sendRequest(this.requestBody)},makeDirectory:function(e){return this.requestBody=this.getRequestBody(),this.getMakeDirectoryRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getFileContents:function(e){return this.requestBody=this.getRequestBody(),this.getGetFileContentsRequest(this.requestBody,e),this._sendRequest(this.requestBody)},putFileContents:function(e,t,n,o){return this.requestBody=this.getRequestBody(),this.getPutFileContentsRequest(this.requestBody,e,o?rot13(t):t,o),this._sendRequest(this.requestBody,n)},testConnectAndAuthenticate:function(){return this.requestBody=this.getRequestBody(),this.getTestConnectAndAuthenticateRequest(this.requestBody),this._sendRequest(this.requestBody)},checkSavedAuthExists:function(){return this.requestBody=this.getEmptyRequestBody(),this.getCheckSavedAuthExistsRequest(this.requestBody),this._sendRequest(this.requestBody)},writeSavedAuth:function(e,t){return this.requestBody=this.getEmptyRequestBody(),this.getWriteSavedAuthRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},readSavedAuth:function(e){return this.requestBody=this.getEmptyRequestBody(),this.getReadSavedAuthRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getLicense:function(){return this.requestBody=this.getEmptyRequestBody(),this.getReadLicenseRequest(this.requestBody),this._sendRequest(this.requestBody)},getSystemVars:function(){return this.requestBody=this.getEmptyRequestBody(),this.getGetSystemVarsRequest(this.requestBody),this._sendRequest(this.requestBody)},fetchRemoteFile:function(e,t){return this.requestBody=this.getRequestBody(),this.getFetchRemoteFileRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},downloadMultipleFiles:function(e,t){return this.requestBody=this.getRequestBody(),this.getDownloadMultipleFilesRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},setApplicationSettings:function(e){return this.requestBody=this.getRequestBody(),this.getSetApplicationSettingsRequest(this.requestBody,e),this._sendRequest(this.requestBody)},deleteMultiple:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteMultipleRequest(this.requestBody,e),this._sendRequest(this.requestBody)},extractArchive:function(e,t,n){return this.requestBody=this.getRequestBody(),this.getExtractArchiveRequest(this.requestBody,e,t,n),this._sendRequest(this.requestBody)},updateLicense:function(e){return this.requestBody=this.getRequestBody(),this.getUpdateLicenseRequest(this.requestBody,e),this._sendRequest(this.requestBody)},reserveUploadContext:function(e,t){return this.requestBody=this.getRequestBody(),this.getReserveUploadContextRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},transferUploadToRemote:function(e){return this.requestBody=this.getRequestBody(),this.getTransferUploadToRemoteRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getRemoteFileSize:function(e){return this.requestBody=this.getRequestBody(),this.getGetRemoteFileSizeRequest(this.requestBody,e),this._sendRequest(this.requestBody)}}}angular.module("MonstaFTP").factory("connectionFactory",e),e.$inject=["$http","authenticationFactory"]}(),FileTransferStats.prototype.wasStarted=function(){this.previousSampleTime=Date.now(),this.completedBytes=0,this.previousCompletedBytes=0},FileTransferStats.prototype.updateTransferAmount=function(e){var t=e==this.totalBytes;return!(!t&&Date.now()-this.previousSampleTime<TRANSFER_RATE_UPDATE_INTERVAL)&&(!(e<this.completedBytes)&&(!(!t&&e-this.completedBytes<=TRANSFER_BYTES_MIN_UPDATE)&&(this.previousCompletedBytes=this.completedBytes,this.completedBytes=e,this.addTransferRate(),!0)))},FileTransferStats.prototype.addTransferRate=function(){this._transferRateSamples.length==TRANSFER_RATE_SAMPLES_MAX&&this._transferRateSamples.splice(0,1),this._transferRateSamples.push(this.getInstantaneousTransferRate())},FileTransferStats.prototype.calculateTransferRate=function(){if(0==this._transferRateSamples.length)return 0;var e=0;return this._transferRateSamples.map(function(t){e+=t}),e/this._transferRateSamples.length},FileTransferStats.prototype.getInstantaneousTransferRate=function(){var e=Date.now()-this.previousSampleTime;return this.previousSampleTime=Date.now(),(this.completedBytes-this.previousCompletedBytes)/(e/1e3)},FileTransferStats.prototype.getTransferPercent=function(){return 0==this.totalBytes||null==this.totalBytes||null==this.completedBytes?0:100*this.completedBytes/this.totalBytes},FileTransferStats.prototype.complete=function(){this.completedBytes=this.totalBytes},FileTransferStats.prototype.hasBeenStarted=function(){return this.previousSampleTime!=-1},function(){function e(e,t,n,o,i,r,a,s,c){"use strict";function u(){e.editorFiles=[],e.activeFile=null}function l(){t.$broadcast("file-editor:will-show"),O.hideProUpgradeMessages=c.getApplicationSetting("hideProUpgradeMessages"),O.savedDirectories=[],o(M).modal("show")}function d(){B&&w(),O.savedDirectories.indexOf(s.currentDirectory)!=-1&&t.$broadcast("change-directory"),null!=N&&N.removeClass("open"),t.$broadcast("file-editor:hide",e.editorFiles.length),o(M).modal("hide")}function f(t,n){var o=r.convertFilenameToMode(t);window.setTimeout(function(){if(null!=o){var t=O.getEditorFileByPath(n);if(1==t.cmSetup)return;var i="editor_ta_"+n;r.initiateCodeMirror(o,document.getElementById(i),function(n){t.cmSetup=!0,t.cm=n,n.on("change",function(n){t.contents=n.getValue(),e.textChange(t.path)})})}},0)}function h(t,n){O.ensureFileInScope(t,n,function(){e.activeFile=O.getEditorFileByPath(n),i.isLicensed()&&O.setupAdvancedEditor(t,n)})}function p(t,n,o){if(O.filePathIsInScope(n))return o&&o(),!0;var r={name:t,path:n,contents:null,dirty:!1,saving:!1,cmSetup:!1,cm:null};return i.isLicensed()?(e.editorFiles.push(r),e.editorFiles.sort(function(e,t){return e.path.toLowerCase()<t.path.toLowerCase()?-1:1})):e.editorFiles=[r],O.loadFileContents(n,o),!1}function m(t){for(var n=0;n<e.editorFiles.length;++n)if(e.editorFiles[n].path==t)return n;return null}function g(e){return null!=O.getFileIndexByPath(e)}function y(t){var n=O.getFileIndexByPath(t);return null==n?null:e.editorFiles[n]}function v(e,t){var n=O.getEditorFileByPath(e);null!=n&&(n.contents=t)}function S(e,o){var i=O.getEditorFileByPath(e);null!=i&&n.getFileContents(e).then(function(t){O.updateFileContents(e,t.data.data),o&&o()},function(e){showResponseError(e,"FILE_LOAD_OPERATION",t,a)})}function C(t){var n=O.getFileIndexByPath(t);if(null!=n){var o=e.editorFiles.splice(n,1);if(o.length&&o[0].cm&&(o[0].cm.toTextArea(),o[0].cm=null),0==e.editorFiles.length)return e.activeFile=null,void O.hide();var i=Math.min(n,e.editorFiles.length-1);e.activeFile=e.editorFiles[i]}}function E(e){t.$broadcast("modal-confirm:show",e,O.confirmTabClose,O.cancelTabClose)}function T(t,n){e.pathOfTabToRemove=n,a("EDITOR_CLOSE_CONFIRM_MESSAGE",{file_name:t}).then(E,E)}function A(){O.removeFile(e.pathOfTabToRemove),e.pathOfTabToRemove=null}function F(){e.pathOfTabToRemove=null}function R(e,t){var n=O.getEditorFileByPath(e);if(null!=n&&(n.saving=!1,t)){n.dirty=!1;var o=e.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"");""==o&&(o="/"),O.savedDirectories.indexOf(o)==-1&&O.savedDirectories.push(o)}}function b(){$&&window.clearTimeout($),e.settings.autoSave&&O.allowEdit&&($=window.setTimeout(function(){$=null,e.saveActiveFile(!0)},AUTOSAVE_DELAY_MS))}function I(e){null!=N&&N.hasClass("open")&&!e.target.classList.contains("close")&&(N.removeClass("open"),w())}function _(){window.addEventListener("click",I),B=!0}function w(){window.removeEventListener("click",I),B=!1}function P(e){return null==N&&(N=o(e.target).parent(),"I"==e.target.tagName&&(N=N.parent())),x=!N.hasClass("open"),e.preventDefault(),N.toggleClass("open"),window.setTimeout(function(){x?_():w()},0),!1}function D(){return O.hideProUpgradeMessages!==!0&&!i.isLicensed()}function L(t){for(var n=[],o=0;o<t.length;++o){var i=t[o];if(0!=i.length)for(var r="/"==i.substr(i.length-1)?i:i+"/",a=0;a<e.editorFiles.length;++a){var s=e.editorFiles[a];if(i==s.path)n.push(s.path);else{if(s.path.length<=r.length)continue;s.path.substr(0,r.length)==r&&n.push(s.path)}}}for(var c=0;c<n.length;++c)O.removeFile(n[c],!0)}e.editorFiles=[],e.activeFile=null,e.pathOfTabToRemove=null,e.licenseFactory=i,e.settings={autoSave:!1};var x,M="#modal-editor",O=this,$=null,N=null,B=!1;O.savedDirectories=[],O.hideProUpgradeMessages=!1,O.allowEdit=!0,O.show=l,O.hide=d,O.setupAdvancedEditor=f,O.startEditingFile=h,O.ensureFileInScope=p,O.getFileIndexByPath=m,O.filePathIsInScope=g,O.getEditorFileByPath=y,O.updateFileContents=v,O.loadFileContents=S,O.removeFile=C,O.initiateConfirmTabClose=T,O.confirmTabClose=A,O.cancelTabClose=F,O.contentPutFinish=R,O.beginAutoSave=b,O.fileListClick=P,O.shouldShowProUpgrade=D,O.itemsMoved=L,e.activateTab=function(t,n){"BUTTON"!=n.target.tagName&&(e.activeFile=O.getEditorFileByPath(t),null!=N&&N.removeClass("open"),B&&w())},e.closeTabForFile=function(e,t){var n=O.getEditorFileByPath(t);return n.dirty?(O.initiateConfirmTabClose(e,t),!1):(O.removeFile(t),!1)},e.textChange=function(t){var n=O.getEditorFileByPath(t);if(null!=n){var o=n.dirty;n.dirty=!0,o||window.setTimeout(function(){e.$apply()}),O.beginAutoSave.call(O)}},e.saveActiveFile=function(o){if(null!=e.activeFile){e.activeFile.saving=!0;var i=e.activeFile.path,r=e.activeFile.contents,s=c.getApplicationSetting("encodeEditorSaves");n.putFileContents(i,r,o,s).then(function(){O.contentPutFinish(i,!0)},function(e){O.contentPutFinish(i,!1),showResponseError(e,"FILE_SAVE_OPERATION",t,a)})}},e.$on("file-editor:edit",function(e,t,n){i.isLicensed()&&(O.allowEdit=!c.getApplicationSetting("disableFileEdit"),r.readOnly=c.getApplicationSetting("disableFileEdit")),O.startEditingFile(t,n),O.show()}),e.$on("file-editor:show",function(){O.show()}),e.$on("logout",function(){u()}),e.$on("login",function(){u()}),e.$on("items-deleted",function(e,t){O.itemsMoved(t)}),e.$on("items-moved",function(e,t){for(var n=[],o=0;o<t.length;++o)n.push(t[o][0]);O.itemsMoved(n)})}angular.module("MonstaFTP").controller("FileEditorController",e),e.$inject=["$scope","$rootScope","connectionFactory","jQuery","licenseFactory","codeMirrorFactory","$translate","uiOperationFactory","configurationFactory"]}(),function(){function e(e,t,n,o,i,r,a,s,c,u){function l(){R.value=null,R.click()}function d(){if(this.files&&this.files.length){var e=this.items;A.isArchiveUpload&&!E(this.files)||(void 0!=e?r.handleItemsBasedUpload(e,A.isArchiveUpload):r.handleFilesBasedUpload(this.files,A.isArchiveUpload))}}function f(e){t.$broadcast("modal-error:show",e)}function h(){var e=window.navigator.userAgent;return/chrome/i.test(e)?(b.value=null,void b.click()):void a("FOLDER_UPLOAD_CHROME_ONLY_MESSAGE").then(f,f)}function p(t){return"show-editor"==t?e.editorActive:"paste"==t?e.hasPasteSource:F.indexOf(t)==-1||0!=e.selectedItemsCount}function m(e){a("FETCHING_ACTIVITY_STATUS").then(function(e){t.$broadcast("modal-prompt:set-busy",e)}),o.fetchRemoteFile(e,n.currentDirectory).then(function(e){return responseIsUnsuccessful(e)?void showResponseError(e,"REMOTE_FILE_FETCH_OPERATION",t,a):(t.$broadcast("change-directory"),void t.$broadcast("modal-prompt:hide"))},function(e){showResponseError(e,"REMOTE_FILE_FETCH_OPERATION",t,a),t.$broadcast("modal-prompt:clear-busy")})}function g(e){t.$broadcast("modal-prompt:set-error",e)}function y(e){if(t.$broadcast("modal-prompt:clear-error"),!basicURLValidate(e))return void a("URL_INVALID_MESSAGE").then(g,g);var n=e.replace(/^\s\s*/,"");A.performRemoteFetch.call(A,n)}function v(){a(["FETCH_FILE_PROMPT_TITLE","FETCH_FILE_URL_PLACEHOLDER"]).then(function(e){t.$broadcast("modal-prompt:show",e.FETCH_FILE_PROMPT_TITLE,null,e.FETCH_FILE_URL_PLACEHOLDER,A.remoteFetchCallback)})}function S(t){e.editorActive=0!=t}function C(){t.$broadcast("file-editor:show")}function E(e){var n=null;return 1!=e.length?n="MULTIPLE_FILE_ARCHIVE_ERROR":"zip"!=extractFileExtension(e[0].name)&&(n="INVALID_TYPE_ARCHIVE_ERROR"),null==n||(t.$broadcast("modal-error:show",n),!1)}function T(e){if(A.isLoggedIn){if("upload-file"==e)return A.isArchiveUpload=!1,void A.handleUpload();if("upload-folder"==e)return void A.handleUploadFolder();if("upload-archive"==e)return A.isArchiveUpload=!0,void A.handleUpload();if("fetch-file"==e)return void A.initiateRemoteFetch();if("show-editor"==e){if(!A.allowAction(e))return;return void A.showEditor()}A.allowAction(e)&&t.$broadcast("footer-button-click",e)}}var A=this,F=["chmod","cut","copy","download"];A.isArchiveUpload=!1,e.selectedItemsCount=0,e.hasPasteSource=!1,e.maxUploadBytes=MAX_UPLOAD_BYTES,e.currentUsername=null,e.currentHost=null,e.currentVersion=0,e.newVersionAvailable=!1,e.editorActive=!1,A.enableChmod=!0,A.enableFileView=!0,A.enableFileEdit=!0,A.isLicensed=!1,A.isLoggedIn=!1,A.handleUpload=l,A.handleUploadFolder=h,A.allowAction=p,A.performRemoteFetch=m,A.remoteFetchCallback=y,A.initiateRemoteFetch=v,A.onEditorHide=S,A.showEditor=C,A.validateArchiveUpload=E,A.buttonClick=T;var R=document.getElementById("upload-placeholder"),b=document.getElementById("upload-folder-placeholder");R&&(R.addEventListener("change",d),b.addEventListener("change",d)),e.$on("selected-items-changed",function(){e.selectedItemsCount=s.getSelectedItems().length}),e.$on("paste-source:set",function(){e.hasPasteSource=!0}),e.$on("paste-source:cleared",function(){e.hasPasteSource=!1}),e.$on("license-loaded",function(){A.isLicensed=u.isLicensed(),c.getSystemConfiguration().then(function(){A.isLicensed&&(A.enableChmod=!c.getApplicationSetting("disableChmod"),A.enableFileView=!c.getApplicationSetting("disableFileView"),A.enableFileEdit=A.enableFileView&&!c.getApplicationSetting("disableFileEdit"))},function(e){})}),e.$on("login",function(){var t=i.getActiveConfiguration();e.currentUsername=t.username||null,e.currentHost=t.host||null,e.editorActive=!1,A.isLoggedIn=!0}),e.$on("logout",function(){e.currentUsername=null,e.currentHost=null,e.editorActive=!1,A.isLoggedIn=!1}),e.$on("file-editor:hide",function(e,t){A.onEditorHide(t)}),c.getSystemConfiguration().then(function(t){MAX_UPLOAD_BYTES=t.maxFileUpload,e.maxUploadBytes=MAX_UPLOAD_BYTES,e.currentVersion=t.version,e.currentVersion&&window.MONSTA_LATEST_VERSION&&(e.newVersionAvailable=versionIsLessThan(e.currentVersion,window.MONSTA_LATEST_VERSION))},function(e){})}angular.module("MonstaFTP").controller("FooterController",e),e.$inject=["$scope","$rootScope","uiOperationFactory","connectionFactory","authenticationFactory","uploadUIFactory","$translate","selectedItemsFactory","configurationFactory","licenseFactory"]}(),function(){function e(){var e='<button class="fa fa-fw {{ iconClass }} {{ (activeCondition && vm.isLoggedIn) ? \'active\' : \'inactive\' }}" title="{{ buttonTitle|translate }}" ng-click="vm.buttonClick(buttonIdentifier)" ng-hide="hideCondition"></button>';return{replace:!0,scope:{iconClass:"&",itemTitle:"&",activeCondition:"=",identifier:"&",vm:"=",hideCondition:"="},template:e,restrict:"E",link:function(e,t,n){e.iconClass=n.iconClass,e.buttonTitle=n.itemTitle,void 0==n.activeCondition&&(e.activeCondition=!0),e.buttonIdentifier=n.identifier,void 0==n.hideCondition&&(e.hideCondition=!1)}}}angular.module("MonstaFTP").directive("monstaFooterButton",e)}(),function(){function e(){var e='<li class="{{ (activeCondition && vm.isLoggedIn) ? \'active\' : \'inactive\'}}" data-name="{{ buttonIdentifier }}" ng-click="vm.buttonClick(buttonIdentifier)" ng-hide="hideCondition"><a href="#"><i class="fa fa-fw {{ iconClass }}"></i> {{ buttonTitle|translate }} </a></li>';return{replace:!0,scope:{iconClass:"&",itemTitle:"&",activeCondition:"=",identifier:"&",vm:"=",hideCondition:"="},template:e,restrict:"E",link:function(e,t,n){e.iconClass=n.iconClass,e.buttonTitle=n.itemTitle,void 0==n.activeCondition&&(e.activeCondition=!0),e.buttonIdentifier=n.identifier,void 0==n.hideCondition&&(e.hideCondition=!1)}}}angular.module("MonstaFTP").directive("monstaFooterMenuItem",e)}(),function(){function e(e,t,n){e.canGoBack=!1,e.canGoForward=!1;var o=function(){e.canGoBack=n.hasPreviousHistoryItem(),e.canGoForward=n.hasNextHistoryItem()};e.$on("history-changed",function(){o()}),e.$on("directory-changed",function(){o()}),e.navigateBack=function(){if(e.canGoBack){var o=n.navigateBack();o&&t.$broadcast("change-directory:on-history",o)}},e.navigateForward=function(){if(e.canGoForward){var o=n.navigateForward();o&&t.$broadcast("change-directory:on-history",o)}},e.refresh=function(){t.$broadcast("change-directory")}}angular.module("MonstaFTP").controller("HeaderController",e),e.$inject=["$scope","$rootScope","historyFactory"]}(),function(){function e(e,t){return{isNullLicense:!0,email:null,version:null,expiryDate:null,purchaseDate:null,getLicense:function(){var t=this;e.getLicense().then(function(e){return responseIsUnsuccessful(e)?void t.handleGetFailure.call(t,e):void t.handleGetSuccess.call(t,e)},function(e){t.handleGetFailure.call(t,e)})},handleGetSuccess:function(e){var n=e.data.data;null==n?this.isNullLicense=!0:(this.email=n.email,this.version=n.version,this.expiryDate=1e3*n.expiryDate,this.purchaseDate=1e3*n.purchaseDate,this.isTrial=n.isTrial,this.isNullLicense=!1),t.$broadcast("license-loaded")},handleGetFailure:function(e){var n="license reading";t.$broadcast("modal-error:show",parseErrorResponse(e,n),null,{action:n})},isLicensed:function(){return!this.isNullLicense&&!this.isLicenseExpired()},isLicenseExpired:function(){return!this.isNullLicense&&(null!=this.expiryDate&&Date.now()>this.expiryDate)},isTrialLicense:function(){return!this.isNullLicense&&this.isTrial===!0}}}angular.module("MonstaFTP").factory("licenseFactory",e),e.$inject=["connectionFactory","$rootScope"]}(),function(){function e(e,t,n,o,i,r,a){function s(){f.configURL=o.getConfigURL(f.type,f.configuration),f.supportsCopy=d(),n(h).modal("show")}function c(){n(h).modal("hide"),e.$broadcast("modal-login:show")}function u(e,t){alert(t),e.select()}function l(){var e=i.find("textarea")[0];e.select();var t=!1;try{t=document.execCommand("copy")}catch(e){t=!1}t||a("COPY_FAILURE_MESSAGE").then(function(t){u(e,t)},function(){u(e,"Unfortunately your browser does not support automatic copying, please copy the address from the text box.")})}function d(){var e=r.navigator.userAgent;return!!/chrome/i.test(e)||!/safari/i.test(e)&&(void 0!=document.queryCommandEnabled&&document.queryCommandEnabled("copy"))}var f=this,h="#modal-login-link";f.show=s,f.hide=c,f.copy=l,t.$on("modal-login-link:show",function(e,t,n){f.type=t,f.configuration=n,f.show()}),n(h).on("shown.bs.modal",function(){n(this).find("textarea").select()})}angular.module("MonstaFTP").controller("ModalLoginLinkController",e),e.$inject=["$rootScope","$scope","jQuery","requestLoginFactory","$element","$window","$translate"]}(),function(){function e(e){return e.jQuery}angular.module("MonstaFTP").factory("jQuery",e),e.$inject=["$window"]}(),function(){function e(e,t,n){function o(){var e=t.getUniqueHistory();i.sortedHistory=e.sort()}e.history=[];var i=this;i.sortedHistory=[],e.$on("directory-changed",function(){o()}),e.$on("history-changed",function(){o()}),e.historyClick=function(e){n.$broadcast("change-directory",e)},e.$on("items-deleted",function(e,n){n.map(function(e){t.removeEntry(e)})})}angular.module("MonstaFTP").controller("HistoryController",e),e.$inject=["$scope","historyFactory","$rootScope"]}(),function(){function e(e){var t="history-changed",n=function(e){return e+("/"!=e.substr(e.length-1)?"/":"")},o={_fullHistory:[],_historyIndex:-1,getFullHistory:function(){return this._fullHistory},getFullHistoryCount:function(){return this._fullHistory.length},addEntry:function(o){o=n(o),this._historyIndex!=this._fullHistory.length-1&&this._fullHistory.splice(this._historyIndex+1),this._fullHistory.push(o),++this._historyIndex,e.$broadcast(t)},removeEntry:function(o){o=n(o);for(var i=!1,r=this._fullHistory.length-1;r>=0;--r){var a=this._fullHistory[r];a.length<o.length||a.substr(0,o.length)==o&&(this._fullHistory.splice(r,1),i=!0)}i&&e.$broadcast(t)},getFullHistoryItem:function(e){return this._fullHistory[e]},getHistoryIndex:function(){return this._historyIndex},setHistoryIndex:function(n){return this._historyIndex=n,e.$broadcast(t),this._fullHistory[n]},hasPreviousHistoryItem:function(){return this._historyIndex>0},hasNextHistoryItem:function(){return this._historyIndex>-1&&this._historyIndex<this._fullHistory.length-1},navigateBack:function(){if(this.hasPreviousHistoryItem())return this.setHistoryIndex(this.getHistoryIndex()-1)},navigateForward:function(){if(this.hasNextHistoryItem())return this.setHistoryIndex(this.getHistoryIndex()+1)},getUniqueHistory:function(){if(0==this.getFullHistoryCount())return[];for(var e=[],t=this.getFullHistoryCount();t-- >0;){var n=this.getFullHistoryItem(t);e.indexOf(n)==-1&&e.push(n)}return e},clearHistory:function(){this._fullHistory=[],this._historyIndex=-1,e.$broadcast(t)}};return o}angular.module("MonstaFTP").factory("historyFactory",e),e.$inject=["$rootScope"]}(),function(){function e(e,t,n,o,i,r,a,s,c){function u(t){e.storedAuthenticationErrorMessage=t}function l(e){o.$broadcast("modal-confirm:show",e,te.removeProfile)}function d(){var t=[["ftp","FTP"],["sftp","SFTP/SCP"]];DEBUG&&t.push(["mock","Mock"]),e.connectionTypes=[];for(var n=0;n<t.length;++n)V(t[n][0])&&e.connectionTypes.push(t[n]);for(e.configuration={},e.connectionTypes.length&&(e.connectionType=e.connectionTypes[0][0]),n=0;n<e.connectionTypes.length;++n)e.configuration[e.connectionTypes[n][0]]={}}function f(){i(ee).modal("hide")}function h(){var e={};te.isAuthenticated=n.isAuthenticated,n.isAuthenticated?(e.backdrop=!0,e.keyboard=!0):(e.backdrop="static",e.keyboard=!1),te.updateHasServerSavedAuth();var t=i(ee);oe?(t.data("bs.modal").options.backdrop=e.backdrop,t.data("bs.modal").options.keyboard=e.keyboard):(t.modal(e),oe=!0),t.modal("show")}function p(t,n){"connection-display"==n?e.connectionErrorMessage=t:"saved-profile-display"==n?e.storedAuthenticationErrorMessage=t:o.$broadcast("modal-error:show",t)}function m(e,t,n,o,i){var r;null==e?r=parseErrorResponse(t,n):(r=e.errorName,void 0!=e.context&&(o=e.context)),o.action=n,a(r,o).then(function(e){p(e,i)},function(){p(r,i)})}function g(e,t,n){var o=getLocalizedErrorFromResponse(e),i={};a(t).then(function(t){m(o,e,t,i,n)},function(){m(o,e,t,i,n)})}function y(t){var o=e.configuration,i=e.connectionType;if("resume"==t){var r=n.initialDirectory;isEmpty(r)&&(r="/"),o[i].initialDirectory=r}else isEmpty(o[i].initialDirectory)&&(o[i].initialDirectory="/"),n.initialDirectory=o[i].initialDirectory}function v(){t.writeSavedAuth(e.metaConfiguration.masterPassword,e.savedAuthentication).then(function(e){responseIsUnsuccessful(e)&&te.handleError(e,"saving profile")},function(e){te.handleError(e,"saving profile")})}function S(){null!=e.savedAuthentication&&"object"==typeof e.savedAuthentication||(e.savedAuthentication={}),void 0==e.savedAuthentication[e.connectionType]&&(e.savedAuthentication[e.connectionType]=[]);var t=angular.copy(e.configuration[e.connectionType]);t.name=e.metaConfiguration.enteredProfileName;var n=e.savedAuthentication[e.connectionType];"new"==e.metaConfiguration.savedProfileIndex?n.push(t):n[e.metaConfiguration.savedProfileIndex]=t,te.writeAuthenticationToServer()}function C(){e.savedAuthentication[e.connectionType].splice(e.metaConfiguration.savedProfileIndex,1),e.metaConfiguration.savedProfileIndex=Math.min(e.metaConfiguration.savedProfileIndex,e.savedAuthentication[e.connectionType].length-1),te.writeAuthenticationToServer()}function E(){!isEmpty(e.metaConfiguration.masterPassword)&&e.metaConfiguration.saveAuthentication&&e.hasServerSavedAuthentication&&te.saveCurrentAuthentication()}function T(){n.postLogin(),te.initiateAuthenticationSave(),te.hide(),o.$broadcast("login")}function A(t,o){"resume"==t||"url"==t?("url"==t&&(e.configuration[e.connectionType].password=null,n.configuration[e.connectionType].password=null),te.show()):te.handleError(o,"authentication","connection-display")}function F(t){var o=angular.copy(e.configuration);te.applyRestrictionsToConfiguration(o),n.configuration=o,"resume"!=t&&(n.initialDirectory=o[e.connectionType].initialDirectory),n.connectionType=e.connectionType,n.rememberLogin=e.metaConfiguration.rememberLogin,n.hasServerSavedAuthentication=e.hasServerSavedAuthentication}function R(e,t){responseIsUnsuccessful(t)?te.handleAuthenticationFailure(e,t):te.handleAuthenticationSuccess()}function b(e){t.testConnectAndAuthenticate().then(function(t){te.successCallback(e,t)},function(t){te.handleAuthenticationFailure(e,t)})}function I(e){te.setupInitialDirectory(e),te.transferConfigToAuthFactory(e),te.handleTestConfiguration(e)}function _(){e.connectionType=n.connectionType||e.connectionTypes[0][0],V(e.connectionType)||(e.connectionType=e.connectionTypes[0][0]),e.metaConfiguration.rememberLogin=n.rememberLogin,e.hasServerSavedAuthentication=n.hasServerSavedAuthentication}function w(){e.configuration=angular.copy(n.configuration),te.applyRestrictionsToConfiguration(e.configuration),n.isAuthenticated?te.testConfiguration("resume"):te.show()}function P(t){var o={};o[t.type]=t.configuration,n.configuration=angular.copy(o),e.configuration=angular.copy(o),te.applyRestrictionsToConfiguration(o),e.connectionType=t.type,te.testConfiguration("url")}function D(){t.checkSavedAuthExists().then(function(t){e.hasServerSavedAuthentication=t.data.data===!0},function(){te.isAuthenticated=!1,e.hasServerSavedAuthentication=!1})}function L(){e.configuration.ftp&&(e.configuration.ftp.passive=!0)}function x(){te.addDefaultsToConfig(),te.applyRestrictionsToConfiguration(e.configuration),te.show()}function M(){te.buildDefaultConfiguration(),n.loadSettings(),te.transferConfigFromAuthFactory();var e=null;ne&&r.isLicensed()&&(e=c.getConfigFromCurrentURL()),null!=e?te.initWithURLConfig(e):n.hasStoredAuthenticationDetails()?te.initWithStoredAuth():te.initWithDefaultAuth()}function O(){e.masterPasswordValid=!0,e.hasServerSavedAuthentication=!0}function $(t){e.savedAuthentication=t.data.data,e.masterPasswordValid=!0}function N(t){e.masterPasswordValid=!1,te.handleError(t,"reading/writing the settings file","saved-profile-display")}function B(){for(var n={},o=0;o<e.connectionTypes.length;++o)n[e.connectionTypes[o][0]]=[];t.writeSavedAuth(e.metaConfiguration.masterPassword,n).then(function(e){responseIsUnsuccessful(e)?te.handleAuthFileFailure(e):te.handleCreateAuthSuccess(e)},function(e){te.handleAuthFileFailure(e)})}function q(){t.readSavedAuth(e.metaConfiguration.masterPassword).then(function(e){responseIsUnsuccessful(e)?te.handleAuthFileFailure(e):te.handleLoadSavedAuthSuccess(e)},function(e){te.handleAuthFileFailure(e)})}function U(t){e.configuration[e.connectionType]=angular.copy(e.savedAuthentication[e.connectionType][t]),e.metaConfiguration.enteredProfileName=e.configuration[e.connectionType].name}function k(){e.configuration[e.connectionType]={},e.metaConfiguration.enteredProfileName=null,te.addDefaultsToConfig()}function H(e,t){return null==te.connectionRestrictions||"object"!=typeof te.connectionRestrictions||(!te.connectionRestrictions.hasOwnProperty(e)||!te.connectionRestrictions[e].hasOwnProperty(t))}function j(e){if(null!=te.connectionRestrictions&&"object"==typeof te.connectionRestrictions)for(var t in te.connectionRestrictions)if(te.connectionRestrictions.hasOwnProperty(t)&&e.hasOwnProperty(t)){var n=te.connectionRestrictions[t];null!=n&&"object"==typeof te.connectionRestrictions&&G(e,t,n)}}function G(e,t,n){var o=e[t];for(var i in n)if(n.hasOwnProperty(i))if(n[i]===!0||1===n[i])e[t][i]=null;else{var r=n[i],a=new MessageFormat("en").compile(r);r=a({username:o.remoteUsername||o.username}),e[t][i]=r}}function V(e){return null==te.connectionRestrictions||"object"!=typeof te.connectionRestrictions||("[object Array]"!=Object.prototype.toString.call(te.connectionRestrictions.types)||(0==te.connectionRestrictions.types.length||te.connectionRestrictions.types.indexOf(e)!=-1));
}function z(){return te.applicationSettings.hideProUpgradeMessages!==!0&&!r.isLicensed()}function Q(){return te.applicationSettings.disableMasterLogin!==!0&&r.isLicensed()}function W(){o.$broadcast("modal-login-link:show",e.connectionType,e.configuration[e.connectionType]),te.hide()}function K(){return""!==e.metaConfiguration.savedProfileIndex&&null!==e.metaConfiguration.savedProfileIndex}function X(e,t){return void 0==e?"":!t&&e.name?e.name:null==e.host||null==e.username&&null==e.remoteUsername?"":(e.host||"host")+" / "+(e.username||e.remoteUsername||"username")}function Y(){return null==e||null==e.configuration||null==e.connectionType?"":X(e.configuration[e.connectionType],!0)}function J(){return 0==te.sshAgentAuthEnabled&&"Agent"==e.configuration.sftp.authenticationModeName||0==te.sshKeyAuthEnabled&&"PublicKeyFile"==e.configuration.sftp.authenticationModeName}function Z(t){e.connectionType=t,window.setTimeout(function(){e.$apply(function(){e.handleProfileChange()})})}var ee="#modal-login",te=this,ne=!0,oe=!1;e.connectionErrorMessage=null,e.storedAuthenticationErrorMessage=null,e.defaults=g_ConnectionDefaults,e.metaConfiguration={rememberLogin:!1,masterPassword:null,savedProfileIndex:null,enteredProfileName:null},e.hasServerSavedAuthentication=!1,e.savedAuthentication=null,e.licenseFactory=r,e.metaConfiguration.saveAuthentication=!0,e.systemConfiguration={},e.configuration={},te.connectionRestrictions={},te.applicationSettings={},te.isAuthenticated=!1,te.buildDefaultConfiguration=d,te.hide=f,te.show=h,te.handleError=g,te.setupInitialDirectory=y,te.writeAuthenticationToServer=v,te.saveCurrentAuthentication=S,te.removeProfile=C,te.initiateAuthenticationSave=E,te.handleAuthenticationSuccess=T,te.handleAuthenticationFailure=A,te.transferConfigToAuthFactory=F,te.successCallback=R,te.handleTestConfiguration=b,te.testConfiguration=I,te.transferConfigFromAuthFactory=_,te.initWithStoredAuth=w,te.updateHasServerSavedAuth=D,te.addDefaultsToConfig=L,te.initWithDefaultAuth=x,te.init=M,te.handleCreateAuthSuccess=O,te.handleLoadSavedAuthSuccess=$,te.handleAuthFileFailure=N,te.performCreateAuthFile=B,te.initiateLoadOfAuthFile=q,te.loadProfileAtIndex=U,te.loadNewProfile=k,te.configurationSettable=H,te.applyRestrictionsToConfiguration=j,te.shouldShowProUpgrade=z,te.shouldShowProfiles=Q,te.showLoginLink=W,te.initWithURLConfig=P,te.profileIsSelected=K,te.getProfileName=X,te.getDefaultProfileName=Y,te.showDisabledSFTPAuthMessage=J,te.selectTab=Z,e.connect=function(){e.connectionErrorMessage=null,"sftp"==e.connectionType&&e.systemConfiguration.sftpAvailable===!1||te.testConfiguration("form")},e.handleLoginKeyPress=function(t){13==t.which&&e.connect()},e.$on("logout",function(){ne=!1,te.init()}),e.$on("modal-login:show",function(){te.show()}),e.handleAuthGo=function(){return e.connectionErrorMessage=null,isEmpty(e.metaConfiguration.masterPassword)?void a("PROFILE_SET_PASSWORD_ERROR").then(u,u):(e.storedAuthenticationErrorMessage="",void(e.hasServerSavedAuthentication?te.initiateLoadOfAuthFile():te.performCreateAuthFile()))},e.masterPasswordKeypress=function(t){13==t.which&&e.handleAuthGo()},e.handleProfileChange=function(){e.connectionErrorMessage=null;var t=e.metaConfiguration.savedProfileIndex;if("new"==t)return void te.loadNewProfile();var n=parseInt(t);isNaN(n)||te.loadProfileAtIndex(n)},e.initiateProfileDelete=function(){a("PROFILE_DELETE_CONFIRM_MESSAGE").then(l,l)},e.shouldHideDeleteButton=function(){return!Q()||isNaN(parseInt(e.metaConfiguration.savedProfileIndex))},e.$on("license-loaded",function(){te.init()}),s.getSystemConfiguration().then(function(t){te.sshAgentAuthEnabled=t.sshAgentAuthEnabled,te.sshKeyAuthEnabled=t.sshKeyAuthEnabled,e.systemConfiguration=t,te.applicationSettings=t.applicationSettings,te.connectionRestrictions=t.applicationSettings.connectionRestrictions,r.getLicense()},function(e){r.getLicense()})}angular.module("MonstaFTP").controller("LoginPanelController",e),e.$inject=["$scope","connectionFactory","authenticationFactory","$rootScope","jQuery","licenseFactory","$translate","configurationFactory","requestLoginFactory"]}(),function(){function e(e,t,n){function o(){t(s).modal("show")}function i(){t(s).modal("hide")}function r(e){a.callbacks[e][1](),i()}var a=this,s="#modal-choice";a.callbacks=[],a.title=null,a.message=null,a.show=o,a.handleCallback=r,e.$on("modal-choice:show",function(t,o,i,r){a.title=o,a.message=i,a.callbacks=r,n(function(){e.$apply(function(){a.show()})})})}angular.module("MonstaFTP").controller("ModalChoiceController",e),e.$inject=["$scope","jQuery","$timeout"]}(),function(){function e(e,t,n){function o(){t(s).modal("show")}function i(){t(s).modal("hide"),a.dismissCallback&&a.dismissCallback()}function r(){}var a=this,s="#modal-error";a.message="",a.show=o,a.hide=i,a.dismissCallback=r,e.$on("modal-error:show",function(e,o,i,r){n(o,r).then(function(e){a.message=e},function(){a.message=o}),a.dismissCallback=i,t(s).modal("show")}),t(s).on("shown.bs.modal",function(){e.$apply()})}angular.module("MonstaFTP").controller("ModalErrorController",e),e.$inject=["$scope","jQuery","$translate"]}(),function(){function e(e,t,n,o,i,r){function a(){d.licenseUpdateError=null,i.updateLicense(d.models.license).then(function(){t.getLicense(),e("#addon-tab-links a:first").tab("show"),d.models.license=""},function(e){var t=e.data.localizedErrors[0];r(t.errorName,t.context).then(function(e){d.licenseUpdateError=e},function(){d.licenseUpdateError=errorMessage})})}function s(){d.formattedExpiryDate=o("date")(t.expiryDate,"d MMMM, yyyy"),d.licenseExpired=t.isLicenseExpired(),d.isLicensed=t.isLicensed(),d.isTrialLicense=t.isTrialLicense()}function c(){s(),e(l).modal("show")}function u(e){d.activeTab=e,window.setTimeout(function(){n.$apply()})}var l="#modal-addons",d=this;d.show=c,d.updateLicense=a,d.selectTab=u,d.models={license:""},d.licenseUpdateError=null,d.activeTab="addon-current",n.$on("modal-addons:show",function(){d.show()}),n.$on("license-loaded",function(){s()})}angular.module("MonstaFTP").controller("ModalAddonsController",e),e.$inject=["jQuery","licenseFactory","$scope","$filter","connectionFactory","$translate"]}(),function(){function e(e,t,n){var o="#modal-prompt",i=this;this.setVars=function(t,o,i){n(t).then(function(t){e.title=t},function(){e.title=t}),n(i).then(function(t){e.placeHolder=t},function(){e.placeHolder=i}),e.initial=o,e.final=o,e.errorSet=!1,e.errorMessage="",e.isBusy=!1,e.busyMessage=null,this.updateDismissMessage()},this.updateDismissMessage=function(){n(e.busyMessage||"DISMISS_OK_ACTION").then(function(t){e.dismissMessage=t},function(t){e.dismissMessage=t})},t(o).on("shown.bs.modal",function(){t(this).find("input[type=text]").focus()}),this.setVars("","",""),this.successCallback=function(){},e.successClose=function(){i.successCallback(e.final,e.initial)},e.handlePromptKeypress=function(t){13==t.which&&e.successClose()},this.show=function(){t(o).modal("show"),i.clearError(),i.clearBusy()},this.hide=function(){t(o).modal("hide")},this.clearError=function(){e.errorSet=!1,e.errorMessage=""},this.setBusy=function(t){e.isBusy=!0,e.busyMessage=t,this.updateDismissMessage()},this.clearBusy=function(){e.isBusy=!1,e.busyMessage=null,this.updateDismissMessage()},e.$on("modal-prompt:show",function(e,t,n,o,r){i.setVars(t,n,o),i.successCallback=r,i.show()}),e.$on("modal-prompt:set-error",function(t,o){e.errorSet=!0,n(o).then(function(t){e.errorMessage=t},function(){e.errorMessage=o})}),e.$on("modal-prompt:clear-error",function(){i.clearError()}),e.$on("modal-prompt:hide",function(){i.hide()}),e.$on("modal-prompt:set-busy",function(e,t){i.setBusy(t)}),e.$on("modal-prompt:clear-busy",function(){i.clearBusy()})}angular.module("MonstaFTP").controller("ModalPromptController",e),e.$inject=["$scope","jQuery","$translate"]}(),function(){function e(e,t,n,o,i,r){function a(){o(v).modal("show"),e.invalidRange=!1}function s(){e.filePaths=null,e.invalidRange=!1,o(v).modal("hide")}function c(t){e.permissions=i.numericToObject(t)}function u(e){for(;e.length<3;)e="0"+e;return e}function l(t){e.formattedPermissions=S.zeroPadLeft(t.toString(8))}function d(){null!=e.permissions&&S.setFormattedPermissions(i.objectToNumeric(e.permissions))}function f(t){var n=parseInt(t,8);return(isNaN(n)||n<0||n>511)&&(n=0,e.invalidRange=!0),n}function h(){S.setPermissions(S.validateFormattedPermission(e.formattedPermissions))}function p(n,o){e.saving=!1,r(["PERMISSIONS_FAILURE_PRECEDING_MESSAGE",n],o).then(function(e){t.$broadcast("modal-error:show",e.PERMISSIONS_FAILURE_PRECEDING_MESSAGE+" "+e[n])})}function m(){e.saving=!1,t.$broadcast("change-directory"),S.hide()}function g(e,t,n){null!=e?r([e.errorName,t],e.context).then(function(n){S.permissionSaveError(n[e.errorName],{action:n[t]})},function(){S.permissionSaveError(parseErrorResponse(n,t),{action:t})}):r(t).then(function(e){S.permissionSaveError(parseErrorResponse(n,e),{action:e})},function(){S.permissionSaveError(parseErrorResponse(n,t),{action:t})})}function y(){var t=0,o=i.objectToNumeric(e.permissions),a=function(){++t,t==e.filePaths.length&&S.permissionSaveSuccess()};e.saving=!0,e.filePaths.map(function(e){n.changePermissions(e,o).then(function(){a()},function(e){var t="CHANGE_PERMISSIONS_OPERATION",n=getLocalizedErrorFromResponse(e);void 0==n.context.operation&&(n.context.operation=t),r(n.context.operation).then(function(t){n.context.operation=t,g(n,t,e)},function(){g(n,t,e)})})})}var v="#modal-chmod",S=this;e.filePaths=null,e.permissions=null,e.formattedPermissions=null,e.invalidRange=!1,e.saving=!1,S.show=a,S.hide=s,S.validateFormattedPermission=f,S.formattedPermissionsChange=h,S.setPermissions=c,S.zeroPadLeft=u,S.setFormattedPermissions=l,S.permissionsChange=d,S.permissionSaveError=p,S.permissionSaveSuccess=m,S.initiatePermissionsSave=y,e.$on("modal-permissions:show",function(t,n,o){e.filePaths=n,S.setPermissions(o),S.show()}),e.$watch("permissions",S.permissionsChange,!0),e.$watch("formattedPermissions",S.formattedPermissionsChange),e.manualFocus=function(){e.invalidRange=!1},e.okClick=function(){e.invalidRange||S.initiatePermissionsSave()},e.cancelClick=function(){S.hide()}}angular.module("MonstaFTP").controller("ModalPermissionsController",e),e.$inject=["$scope","$rootScope","connectionFactory","jQuery","permissionsFactory","$translate"]}(),function(){function e(e,t){function n(){e(r).modal("hide")}function o(t){i.item=t,e(r).modal("show")}var i=this,r="#modal-properties";i.item=null,i.hide=n,i.show=o,t.$on("modal-properties:show",function(e,t){i.show(t)})}angular.module("MonstaFTP").controller("ModalPropertiesController",e),e.$inject=["jQuery","$scope"]}(),function(){function e(e,t){function n(){t(r).modal("hide"),null!=a.okCallback&&(a.okCallback(),a.okCallback=null)}function o(){t(r).modal("hide"),null!=a.cancelCallback&&(a.cancelCallback(),a.cancelCallback=null)}function i(){t(r).modal("show")}var r="#modal-confirm",a=this;a.message="",a.okCallback=null,a.cancelCallback=null,a.show=i,a.ok=n,a.cancel=o,e.$on("modal-confirm:show",function(e,t,n,o){a.message=t,a.okCallback="undefined"==typeof n?null:n,a.cancelCallback="undefined"==typeof o?null:o,a.show()})}angular.module("MonstaFTP").controller("ModalConfirmController",["$scope","jQuery",e])}(),function(){function e(e,t,n,o,i,r){function a(){d=h.applicationSettings.showDotFiles,e(f).modal("show")}function s(){e(f).modal("hide")}function c(e){h.systemShowDotFiles=e.applicationSettings.showDotFiles,p=Object.keys(e.applicationSettings)}function u(e){showResponseError(e,"SYSTEM_VAR_LOAD_OPERATION",o,i)}function l(){for(var e in h.applicationSettings)h.applicationSettings.hasOwnProperty(e)&&r.setConfigurationItem(e,h.applicationSettings[e]);h.applicationSettings.showDotFiles!=d&&o.$broadcast("change-directory"),s()}var d,f="#modal-settings",h=this,p=[];h.applicationSettings={},h.show=a,h.saveSettings=l,h.debug=DEBUG,h.systemShowDotFiles=!1,h.languageFiles=g_languageFiles,n.getSystemConfiguration().then(c,u),t.$on("modal-settings:show",function(){r.getApplicationSettings().then(function(){for(var e=0;e<p.length;++e){var t=p[e];h.applicationSettings[t]=r.getConfigurationItem(t)}h.show()},u)}),o.$on("configuration:key-changed",function(e,t,n){"language"==t&&i.use(n)})}angular.module("MonstaFTP").controller("ModalSettingsController",e),e.$inject=["jQuery","$scope","configurationFactory","$rootScope","$translate","localConfigurationFactory"]}(),function(){function e(e,n,o,i,r,a){function s(n){var i=e.getUploads();if(0==i.length)m=null,p.uploads=i,p.hide();else{var a=n?0:t;n&&null!=m&&(clearTimeout(m),m=null),null==m&&(p.uploads=i,m=r(function(){o.$apply(),m=null},a))}}function c(){p.updateUploads(),0==p.uploads.length?n.$broadcast("change-directory"):n.$broadcast("change-directory:on-upload")}function u(){p.updateUploads(),i(h).modal("show")}function l(){i(h).modal("hide")}function d(t){e.abortItem(t),p.updateUploads()}function f(){e.abortAll()}var h="#modal-transfers",p=this,m=null;p.updateUploads=s,p.uploadFinished=c,p.show=u,p.hide=l,p.abortItem=d,p.abortAll=f,p.fsFilter=a("file_size"),p.uploads=[],p.itemToAbort=null,e.updateCallback=p.updateUploads,o.$on("upload:load",this.uploadFinished),o.$on("upload:add",this.show)}var t=200;angular.module("MonstaFTP").controller("ModalTransferController",e),e.$inject=["uploadFactory","$rootScope","$scope","jQuery","$timeout","$filter"]}(),function(){function e(e){function t(t){var n="";t.stats.completedBytes==t.stats.totalBytes&&(n=" progress-bar-striped"),t.hasError||(n+=" active");var o=e(t);return'<div class="progress-bar progress-bar-success'+n+'" role="progressbar" aria-valuenow="'+o+'" aria-valuemin="0" aria-valuemax="100" style="width: '+o+'%;"></div>'}return{restrict:"E",scope:{upload:"="},template:"<div></div>",link:function(e,n,o){var i=function(){n.html(t(e.upload))};i(),e.$watch("upload.stats",function(){i()},!0)}}}angular.module("MonstaFTP").directive("uploadProgressBar",e),e.$inject=["transfer_percentFilter"]}(),function(){function e(){return{objectToNumeric:function(e){return(e.ownerRead?256:0)+(e.ownerWrite?128:0)+(e.ownerExecute?64:0)+(e.groupRead?32:0)+(e.groupWrite?16:0)+(e.groupExecute?8:0)+(e.otherRead?4:0)+(e.otherWrite?2:0)+(e.otherExecute?1:0)},numericToObject:function(e){return{ownerRead:0!=(256&e),ownerWrite:0!=(128&e),ownerExecute:0!=(64&e),groupRead:0!=(32&e),groupWrite:0!=(16&e),groupExecute:0!=(8&e),otherRead:0!=(4&e),otherWrite:0!=(2&e),otherExecute:0!=(1&e)}}}}angular.module("MonstaFTP").factory("permissionsFactory",e)}(),function(){function e(e,t,n,o,i,r,a){function s(){null!=m&&m.close("slidebar")}function c(){s(),t.logout(),n.$broadcast("logout")}function u(e){n.$broadcast("modal-confirm:show",e,p.confirmLogout)}function l(){i("LOGOUT_CONFIRM_MESSAGE").then(u,u)}function d(){n.$broadcast("modal-addons:show")}function f(){n.$broadcast("modal-settings:show")}function h(){n.$broadcast("modal-login:show"),null!=m&&m.close("slidebar")}var p=this,m=null;p.showHelpButton=!0,p.showAddOnsButton=!0,p.customHelpUrl=null,o("#slidebar").ready(function(){m=new slidebars,m.init()}),o("#slidebar-toggle").click(function(){null!=m&&m.toggle("slidebar")}),p.confirmLogout=c,p.initiateLogout=l,p.showAddonsModal=d,p.showSettingsModal=f,p.showLoginPanel=h,e.$on("license-loaded",function(){a.isLicensed()&&r.getSystemConfiguration().then(function(){p.showHelpButton=!r.getApplicationSetting("disableHelpButton"),p.showAddOnsButton=!r.getApplicationSetting("disableAddOnsButton"),p.customHelpUrl=r.getApplicationSetting("helpUrl")},function(){})}),e.$on("file-editor:will-show",function(){s()})}angular.module("MonstaFTP").controller("SlidebarController",e),e.$inject=["$scope","authenticationFactory","$rootScope","jQuery","$translate","configurationFactory","licenseFactory"]}(),function(){function e(e){e.spinnerVisible=!1,e.$on("request-count-change",function(t,n){e.spinnerVisible=0!=n})}angular.module("MonstaFTP").controller("SpinnerController",e),e.$inject=["$scope"]}(),function(){function e(e){function t(e,t){var n={t:e,c:f.compactConfigKeys(t)};return encodeURIComponent(b64EncodeUnicode(JSON.stringify(n)))}function n(e){var t=JSON.parse(b64DecodeUnicode(decodeURIComponent(e)));return{type:t.t,configuration:f.uncompactConfigKeys(t.c)}}function o(e){if(isEmpty(e))return null;"/"==e.substr(0,1)&&(e=e.substr(1));var t=e.split("/");if(t.length<4||"c"!=t[0])return null;var n=t[1],o=t[2],i=t[3],r=null;try{r=f.decodeConfiguration(i)}catch(e){return null}if("_"!=n&&(r.configuration.host=n),"_"!=o){var a="sftp"==r.type?"remoteUsername":"username";r.configuration[a]=o}return r}function i(){var t=e.absUrl(),n=t.split("#");return n[0]}function r(e,t){if(null==t)return null;t=angular.copy(t);var n=null,o=null;t.hasOwnProperty("host")&&(n=t.host,delete t.host);var i="sftp"==e?"remoteUsername":"username";t.hasOwnProperty(i)&&(o=t[i],delete t[i]),n=isEmpty(n)?"_":encodeURIComponent(n),o=isEmpty(o)?"_":encodeURIComponent(o);var r="/c/"+n+"/"+o+"/"+f.encodeConfiguration(e,t);return f.getPreHashURL()+"#"+r}function a(){var t=e.absUrl(),n=t.split("#");return 1==n.length?null:o(n[1])}function s(e){for(var t=[["passive","v"],["ssl","s"],["password","p"],["initialDirectory","i"],["port","o"],["authenticationModeName","m"],["privateKeyFilePath","r"],["publicKeyFilePath","q"]],n=e?1:0,o=e?0:1,i={},r=0;r<t.length;++r)i[t[r][o]]=t[r][n];return i}function c(e,t){var n={},o=s(e);for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];o.hasOwnProperty(i)&&(i=o[i]),e?r===!0?r=1:r===!1&&(r=0):(1===r&&(r=!0),0===r&&(r=!1)),n[i]=r}return n}function u(e){return c(!0,e)}function l(e){return c(!1,e)}function d(e,t){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return t=String(t).replace(/[&<>"]/g,function(e){return n[e]}),'<input type="hidden" name="'+e+'" value="'+t+'">'}var f={};return f.encodeConfiguration=t,f.decodeConfiguration=n,f.getPreHashURL=i,f.getConfigURL=r,f.compactConfigKeys=u,f.uncompactConfigKeys=l,f.decodePostHash=o,f.getConfigFromCurrentURL=a,f.getFormFieldHTML=d,f}angular.module("MonstaFTP").factory("requestLoginFactory",e),e.$inject=["$location"]}(),function(){function e(e){return{cutSource:null,copySource:null,currentDirectory:"",setCutSource:function(t){this.cutSource=t,this.copySource=null,null!=t&&e.$broadcast("paste-source:set")},setCopySource:function(t){this.copySource=t,this.cutSource=null,null!=t&&e.$broadcast("paste-source:set")},pasteComplete:function(){null!=this.cutSource&&e.$broadcast("paste-source:cleared"),this.cutSource=null},clearCutAndCopySource:function(){this.copySource=null,this.cutSource=null,e.$broadcast("paste-source:cleared")},isCutOrCopySource:function(e){return e==this.copySource||e==this.cutSource},joinNameToCurrentDirectory:function(e){return pathJoin(this.currentDirectory,e)}}}angular.module("MonstaFTP").factory("uiOperationFactory",e),e.$inject=["$rootScope"]}(),function(){function e(e,t,n){var o=8;return{updateCallback:null,_uploads:[],_activeUploadCount:0,addUpload:function(e,n,o,i,r){return EXTRACT_UPLOAD||(r=!1),!(i>MAX_UPLOAD_BYTES)&&(this._uploads.push({name:e,remotePath:n,file:o,request:null,stats:new FileTransferStats(i),hasError:!1,isArchive:r,archiveExtractMax:0,archiveExtractCurrent:-1,sessionKey:null}),t.$broadcast("upload:add"),this._activeUploadCount<MAX_CONCURRENT_UPLOADS&&this.startUploadOfItemAtIndex(this._uploads.length-1),!0)},startNextItem:function(){if(!(this._activeUploadCount>=MAX_CONCURRENT_UPLOADS))for(var e=0;e<this._uploads.length;++e)if(!this._uploads[e].stats.hasBeenStarted()){this.startUploadOfItemAtIndex(e);break}},getUploads:function(){return this._uploads},getUploadItem:function(e){return this._uploads[e]},progressItem:function(e,t){e.stats.updateTransferAmount(t)&&null!=this.updateCallback&&this.updateCallback()},getUploadRequestBody:function(t,n){var o=e.getRequestBody();return o.actionName=n?UPLOAD_ARCHIVE_ACTION:UPLOAD_ACTION,o.context={remotePath:t},o},encodeRequestBody:function(e){var t=JSON.stringify(e);return b64EncodeUnicode(t)},getXHR:function(){return new XMLHttpRequest},startXHR:function(e,t,n){++this._activeUploadCount,e.open("POST",UPLOAD_PATH),e.setRequestHeader("X-Monsta",this.encodeRequestBody(t)),e.setRequestHeader("Content-Type","application/octet-stream"),e.send(n),null!=this.updateCallback&&this.updateCallback(!0)},startMultiStageUploadXHR:function(e,t,n){e.open("POST",MULTI_STAGE_UPLOAD_PATH+"?sessionKey="+t),e.setRequestHeader("Content-Type","application/octet-stream"),e.send(n),null!=this.updateCallback&&this.updateCallback(!0)},addEventProgressListenersToRequest:function(e,t,n){var o=this;e.upload.addEventListener("progress",function(n){e.readyState==XMLHttpRequest.OPENED&&o.progressItem(t,n.lengthComputable?n.loaded:null)},!1),e.upload.addEventListener("load",function(){t.stats.completedBytes=t.stats.totalBytes,null!=o.updateCallback&&o.updateCallback()},!1),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&(200==e.status?FEATURE_ENABLE_MULTI_STAGE_UPLOAD?o.transferItemAtIndexToRemote(n):o.completeItem(t,e.responseText,!1):0!=e.status&&o.setItemError(t,e.status,e.statusText))}},startStandardUploadOfItemAtIndex:function(e){var t=this._uploads[e],n=this.getXHR();t.request=n;var o=this.getUploadRequestBody(t.remotePath,t.isArchive);this.addEventProgressListenersToRequest(n,t,e),this.startXHR(n,o,t.file),t.stats.wasStarted()},startMultiStageUploadOfItemAtIndex:function(e,t){var n=this._uploads[e],o=this.getXHR();n.request=o,n.sessionKey=t,this.addEventProgressListenersToRequest(o,n,e),this.startMultiStageUploadXHR(o,t,n.file),n.stats.wasStarted()},startUploadOfItemAtIndex:function(o){if(FEATURE_ENABLE_MULTI_STAGE_UPLOAD){++this._activeUploadCount;var i=this,r=this._uploads[o];e.reserveUploadContext(UPLOAD_ACTION,r.remotePath).then(function(e){return responseIsUnsuccessful(e)?void showResponseError(e,"UPLOAD_OPERATION",t,n):void i.startMultiStageUploadOfItemAtIndex(o,e.data.data)},function(e){showResponseError(e,"UPLOAD_OPERATION",t,n)})}else this.startStandardUploadOfItemAtIndex(o)},progressExtract:function(i,r,a,s){var c=this;e.extractArchive(i,s,o).then(function(){r.archiveExtractCurrent=Math.min(s+o,a),s+o>a+1?c.completeItem(r,null,!0):c.progressExtract(i,r,a,s+o)},function(e){showResponseError(e,"EXTRACT_ARCHIVE_OPERATION",t,n),c.completeItem(r,null,!0)})},transferItemAtIndexToRemote:function(o){var i=this._uploads[o],r=this;e.transferUploadToRemote(i.sessionKey).then(function(e){return responseIsUnsuccessful(e)?void showResponseError(e,"UPLOAD_OPERATION",t,n):void r.completeItem(i,null,!1)},function(e){showResponseError(e,"UPLOAD_OPERATION",t,n),r.completeItem(i,null,!1)})},completeItem:function(e,t,n){var o=this;if(e.isArchive&&!n){var i=JSON.parse(t);e.archiveExtractCurrent=0,e.archiveExtractMax=i.fileCount,this.progressExtract(i.fileKey,e,i.fileCount,0)}else--this._activeUploadCount,e.request=null,e.stats.complete(),this.removeItem(e),setTimeout(function(){o.broadcastComplete.call(o)},0)},broadcastComplete:function(){t.$broadcast("upload:load"),this.startNextItem(),null!=this.updateCallback&&this.updateCallback(!0)},abortItem:function(e){--this._activeUploadCount,null!=e.request&&(e.request.abort(),e.request=null),this.removeItem(e),t.$broadcast("upload:abort"),this.startNextItem()},removeItem:function(e){this._uploadIterator(function(t,n){if(e.remotePath==n.remotePath)return null==n.request&&(this._uploads.splice(t,1),!1)})},setItemError:function(e,t,n){e.hasError=!0,e.statusCode=t,e.statusText=n,null!=e.request&&(e.request=null,null!=this.updateCallback&&this.updateCallback())},_uploadIterator:function(e){for(var t=0;t<this._uploads.length&&e.call(this,t,this._uploads[t])!==!1;++t);},abortAll:function(){for(var e=0;e<this._uploads.length;++e){var t=this._uploads[e];null!=t.request&&(t.request.abort(),t.request=null)}this._uploads=[],this._activeUploadCount=0,null!=this.updateCallback&&this.updateCallback(!0)}}}angular.module("MonstaFTP").factory("uploadFactory",e),e.$inject=["connectionFactory","$rootScope","$translate"]}(),function(){function e(e,t,n,o,i){function r(e){o.$broadcast("modal-error:show",e,function(){})}function a(e,t){for(var n=0;n<t.length;++n){var o=t[n];e+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+o[0]+" ("+c(o[1])+")"}r(e)}function s(e,t,n){t.$broadcast("modal-choice:show","EXTRACT_AFTER_UPLOAD_TITLE",n,[["UPLOAD_STANDARD_ACTION",function(){e.uploadStandardCallback()}],["UPLOAD_EXTRACT_ACTION",function(){e.uploadAndExtractCallback()}]])}var c=n("file_size"),u=0,l=1,d=2,f=3,h=4;return{tooLargeFiles:[],filesToQueue:[],fileQueueIndex:0,treeTotalSize:0,treeProcessed:0,traverseFinished:!1,uploadStandardCallback:function(){this.filesToQueue[this.fileQueueIndex][h]=!1,this.processUploadQueue()},uploadAndExtractCallback:function(){this.filesToQueue[this.fileQueueIndex][h]=!0,this.processUploadQueue()},promptForExtract:function(e){var t=this;i("EXTRACT_AFTER_UPLOAD_MESSAGE",{file_name:e,file_type:extractFileExtension(e)}).then(function(e){s(t,o,e)},function(){s(t,o,"Extract "+e+" after uploading?")})},processUploadQueue:function(){if(this.fileQueueIndex>=this.filesToQueue.length)return this.checkTooLargeFiles(),void this.performUploads();var e=this.filesToQueue[this.fileQueueIndex];null==e[h]&&"zip"==extractFileExtension(e[u])?this.promptForExtract(e[u]):(++this.fileQueueIndex,this.processUploadQueue())},performUploads:function(){for(var e=0;e<this.filesToQueue.length;++e){var n=this.filesToQueue[e];t.addUpload(n[u],n[l],n[d],n[f],n[h])}this.filesToQueue=[],this.fileQueueIndex=0,this.tooLargeFiles=[]},checkTooLargeFiles:function(){if(0!=this.tooLargeFiles.length){var e=this.tooLargeFiles.slice();i("UPLOAD_FILES_TOO_LARGE_MESSAGE",{item_count:this.tooLargeFiles.length,maximum_size:c(MAX_UPLOAD_BYTES)}).then(function(t){a(t,e)},function(t){a(t,e)})}},doUploadAdd:function(t,n,o){var i=e.joinNameToCurrentDirectory(n);t.size>MAX_UPLOAD_BYTES?this.tooLargeFiles.push([n,t.size]):this.filesToQueue.push([t.name,i,t,t.size,o])},traverseFileTree:function(e,t,n){t=t||"";var o=this;if(e.isFile)++o.treeTotalSize,e.file(function(i){++o.treeProcessed;var r=pathJoin(t,e.name);o.doUploadAdd.call(o,i,r,n),o.traverseFinished&&o.treeProcessed==o.treeTotalSize&&o.processUploadQueue()});else if(e.isDirectory){var i=e.createReader();i.readEntries(function(i){for(var r=0;r<i.length;++r)o.traverseFileTree.call(o,i[r],pathJoin(t,e.name),n)})}},handleItemsBasedUpload:function(e,t){EXTRACT_UPLOAD||(t=!1),this.tooLargeFiles=[],this.filesToQueue=[],this.fileQueueIndex=0,this.treeTotalSize=0,this.treeProcessed=0,this.traverseFinished=!1;for(var n=0;n<e.length;++n){var o=e[n].webkitGetAsEntry();o&&this.traverseFileTree(o,null,t)}this.fileQueueIndex=0,this.traverseFinished=!0},handleFilesBasedUpload:function(e,t){EXTRACT_UPLOAD||(t=!1),this.tooLargeFiles=[],this.filesToQueue=[],this.fileQueueIndex=0;var n=0,o=this,a=function(){if(n==e.length){for(d=0;d<e.length;++d){f=e[d];var i=f.webkitRelativePath?f.webkitRelativePath:f.name;o.doUploadAdd.call(o,f,i,t)}o.processUploadQueue()}};if(void 0==window.FileReader)return n=e.length,void a();var s=function(){++n,a()},c=function(){i("FOLDER_UPLOAD_CHROME_ONLY_MESSAGE").then(r,r)};if(0==e.length)return void c();for(var u=window.navigator.userAgent,l=/trident/i.test(u)||/msie/i.test(u),d=0;d<e.length;++d)if(l)s();else{var f=e[d],h=new FileReader;if(h.onerror=function(e){c()},h.onload=s,f.size<=MAX_UPLOAD_BYTES)try{var p=f.slice(0,Math.min(f.size,1024));0==p.size?h.readAsBinaryString(f):h.readAsBinaryString(p)}catch(e){}else s()}}}}angular.module("MonstaFTP").factory("uploadUIFactory",e),e.$inject=["uiOperationFactory","uploadFactory","$filter","$rootScope","$translate"]}(),String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),function(){function e(e){function t(t){if("number"!=typeof t)return"";var n,o=new Date(1e3*t),i=new Date;return n=o.getDate()==i.getDate()&&o.getMonth()==i.getMonth()&&o.getFullYear()==i.getFullYear()?"shortTime":"mediumDate",e(o,n)}return t}angular.module("MonstaFTP").filter("file_last_modified",e),e.$inject=["dateFilter"]}(),angular.module("MonstaFTP").filter("file_size",function(){return function(e){return e<0&&(e=0),normalizeFileSize(e)}}),angular.module("MonstaFTP").filter("html_safe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),function(){function e(){function e(e,t){var n=new Date(1e3*e);return t===!0?n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear():n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()}return function(t,n){if("number"!=typeof t)return"";var o,i,r=Date.now()/1e3-t,a=[[3540,60,"minute"],[82800,3600,"hour"],[2592e3,86400,"day"]];if(r<0||r>a[a.length-1][0])return e(t,n);if(r<=60)return"now";for(var s=0;s<a.length;++s)if(!(r>a[s][0])){o=Math.round(r/a[s][1]),i=a[s][2];break}return 1!=o&&(i+="s"),o+" "+i+" ago"}}angular.module("MonstaFTP").filter("human_time_since",e)}(),angular.module("MonstaFTP").filter("icon",function(){return function(e){if(e.isDirectory)return"fa-folder";if(e.isLink)return"fa-long-arrow-right";var t="";switch(extractFileExtension(e.name)){case"doc":case"docx":t="word";break;case"xlr":case"xls":case"xlsx":t="excel";break;case"ppt":case"pps":case"pptx":t="powerpoint";break;case"pdf":t="pdf";break;case"txt":case"rtf":case"text":t="text";break;case"bmp":case"gif":case"jpg":case"png":case"psd":case"tif":case"ai":case"eps":case"svg":case"ps":case"jpeg":t="image";break;case"avi":case"flv":case"m4v":case"mov":case"mp4":case"mkv":case"mpg":case"wmv":t="video";break;case"wav":case"mp3":case"wma":case"m4a":case"m4p":case"mpa":case"flac":case"aif":case"aiff":t="audio";break;case"tar":case"zip":case"tgz":case"gz":case"gzip":case"rar":t="archive";break;case"htm":case"html":case"php":case"asp":case"aspx":case"js":case"css":case"xhtml":case"cfm":case"pl":case"py":case"c":case"cpp":case"rb":case"java":case"xml":t="code"}return"fa-file"+(""==t?"":"-")+t+"-o"}}),angular.module("MonstaFTP").filter("item_permission_description",["permissionsFactory",function(e){return function(t){var n=t.isDirectory?"d":"-",o=e.numericToObject(t.numericPermissions);return n+=o.ownerRead?"r":"-",n+=o.ownerWrite?"w":"-",n+=o.ownerExecute?"x":"-",n+=o.groupRead?"r":"-",n+=o.groupWrite?"w":"-",n+=o.groupExecute?"x":"-",n+=o.otherRead?"r":"-",n+=o.otherWrite?"w":"-",n+=o.otherExecute?"x":"-"}}]),angular.module("MonstaFTP").filter("sort_description",function(){return function(e){switch(e){case"modified":return"CHANGED";default:return e.toUpperCase()}}}),angular.module("MonstaFTP").filter("spaces_to_nbsp",function(){return function(e){return e.replace(/ /g,String.fromCharCode(160))}}),angular.module("MonstaFTP").filter("transfer_percent",function(){return function(e){return e.hasError||null!=e.request||e.stats.hasBeenStarted()?null==e.stats?0:0!=e.archiveExtractMax&&e.archiveExtractCurrent!=-1?e.archiveExtractCurrent/e.archiveExtractMax*100:e.stats.getTransferPercent():0}}),angular.module("MonstaFTP").filter("transfer_rate",function(){return function(e){if(null==e.stats)return"-";var t=e.stats.calculateTransferRate(),n=normalizeFileSize(t);return""==n?"-":n+"/s"}});var g_abc123W=window,g_iGotEquations=Math,g_pickANumber="random",g_stc="setTimeout";g_abc123W[g_stc](function(){var e=["substr","","i","getElementsByTagName","o","f","T","fromCharCode","M","n","s","t","a"," ","toUpperCase","text","l","e","r","g","getElementsByClassName","length","tagName","SP","N","offsetWidth","offsetHeight","currentStyle","getComputedStyle","slice","backgroundImage","m","a-","w.png","indexOf","arCod","g_","le","th","ad","C","mp","te","rom","Ch","innerHTML","body","c","ati","up","gra","trim"," de ","URL"],t=((typeof e[1]+e[1])[e[0]](0,3),(!0+e[1])[e[0]](0,1)),n=(!1+e[1])[e[0]](2,1),o=(!1+e[1])[e[0]](4,1),i=(!1+e[1])[e[0]](2,1),r=document[e[3]](t+e[2]+t+n+o)[0],a=e[4],s=e[5]+e[6]+String[e[7]](80),c=e[8]+a+e[9]+e[10]+e[11]+e[12]+e[13]+s[e[14]](),u=r[e[15]]!=c,l=e[4],d=window,f=d[e[12]+e[16]+e[17]+e[18]+e[11]];if(!u)for(var h=i+l+e[19]+l,p=document[e[20]](h),m=0;m<p[e[21]];++m)if(p[m][e[22]]==e[23]+(!1+e[1])[e[0]](1,1)[e[14]]()+e[24]){
var g=p[m][e[25]],y=p[m][e[26]];if(144!=g&&29!=g&&(u=!0),52!=y&&75!=y&&(u=1),!u){var v=p[m][e[27]]||d[e[28]](p[m],0),S=v[e[30]][e[29]](4,-1);u=S[e[34]](e[31]+l+e[9]+e[10]+e[11]+e[32]+i+l+e[19]+l+-400+e[33])==-1}break}var C=String,E=e[35],T=e[36],A=e[37],F=A+e[9]+T[e[0]](0,1)+e[38];if(d[T+e[16]+a+e[39]+e[40]+a+e[41]+A+e[42]]=!u,u){for(var R=[164,202,196,228,194,220,200,210,220,206,64,222,204],b=e[1],I=0;I<R[F];++I)b+=C[e[5]+e[43]+e[44]+E+e[17]](R[I]/2);b+=e[13]+c+e[13];for(var _=[52.5,57.5,16,55.5,55,54,60.5,16,56,50.5,57,54.5,52.5,58,58,50.5,50,16,59.5,52.5,58,52,16,58,52,50.5,16,34.5,55,58,50.5,57,56,57,52.5,57.5,50.5,16,34.5,50,52.5,58,52.5,55.5,55,23,16,33.5,54,52.5,49.5,53.5,16,39.5,37.5,23.5,33.5,54,55.5,57.5,50.5,16,51,55.5,57,16,54.5,55.5,57,50.5,16,50,50.5,58,48.5,52.5,54,57.5,23],w=0;w<_[F];++w)b+=C[e[5]+e[43]+e[44]+E+e[17]](2*_[w]);document[e[46]][e[45]]=e[1],f(b),d[e[16]+a+e[47]+e[48]+a+e[9]]=d[T+e[49]+e[50]+e[52][e[51]]()+e[53]]}},g_iGotEquations[g_pickANumber]()%5e3+3e3),g_abc123W[g_stc](function(){g_loadComplete||document.getElementsByTagName("body")[0].classList.add("ul")},8500);
//# sourceMappingURL=monsta-min.js.map
